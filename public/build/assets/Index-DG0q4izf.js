import{l as T,m as U,r as p,a as v,o as V,c as d,b as y,u as h,h as j,w as _,d as e,k as w,q as k,e as m,f as r,F as C,g as I,t as u,i as E,j as D}from"./app-CIgItLJv.js";import{_ as L}from"./AuthenticatedLayout-DJwHHg2a.js";import{a as x}from"./api-VVF87TnZ.js";const X={class:"py-10"},q={class:"mx-auto max-w-7xl space-y-6 px-4 sm:px-6 lg:px-8"},z={class:"grid gap-6 lg:grid-cols-3"},A={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm lg:col-span-2"},O={class:"mb-4 flex items-center gap-3"},G=["disabled"],H={class:"overflow-hidden rounded-lg border border-gray-200"},J={class:"overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200"},Q={class:"divide-y divide-gray-200 bg-white"},R={key:0},W={class:"px-6 py-4"},Y={class:"font-medium text-gray-900"},Z={class:"px-6 py-4"},ee={class:"px-6 py-4"},te={class:"px-6 py-4 text-right"},se={class:"flex items-center justify-end gap-2"},oe=["onClick"],le=["href"],ae=["onClick","disabled"],ie={key:0,class:"flex flex-col items-center justify-between gap-4 border-t border-gray-100 px-6 py-4 text-sm text-gray-600 sm:flex-row"},de={class:"flex items-center gap-2"},re=["disabled"],ne=["disabled"],ue={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm"},ce={class:"mt-4 space-y-4"},pe=["disabled"],be={__name:"Index",setup(ge){const P=T(),B=U(()=>P.props.auth?.user?.role==="super-admin"),l=p(!1),g=p([]),a=p(null),c=v({search:"",page:1,limit:10}),f=p(null),i=v({title:"",file:null}),n=async()=>{l.value=!0;try{const{data:s}=await x.get("/books",{params:c});g.value=s.books,a.value=s.pagination}catch(s){console.error(s)}finally{l.value=!1}},b=s=>{a.value&&(s<1||s>a.value.totalPages||(c.page=s,n()))},F=s=>{const[t]=s.target.files??[];i.file=t??null},$=()=>{i.title="",i.file=null,f.value&&(f.value.value="")},S=async()=>{if(!i.title||!i.file)return;const s=new FormData;s.append("title",i.title),s.append("file",i.file);try{l.value=!0,await x.post("/books",s,{headers:{"Content-Type":"multipart/form-data"}}),$(),await n()}catch(t){console.error(t)}finally{l.value=!1}},M=async s=>{if(confirm(`Delete ${s.title}?`))try{l.value=!0,await x.delete(`/books/${s.id}`),await n()}catch(t){console.error(t)}finally{l.value=!1}};return V(n),(s,t)=>(r(),d(C,null,[y(h(j),{title:"Books"}),y(L,null,{header:_(()=>[...t[5]||(t[5]=[e("div",{class:"flex items-center justify-between"},[e("div",null,[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Books "),e("p",{class:"text-sm text-gray-500"}," Manage lesson materials, download resources, and upload new content. ")])],-1)])]),default:_(()=>[e("div",X,[e("div",q,[e("div",z,[e("div",A,[e("div",O,[w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>c.search=o),type:"text",class:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Search title or filename"},null,512),[[k,c.search]]),e("button",{onClick:n,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:l.value}," Search ",8,G)]),e("div",H,[e("div",J,[e("table",K,[t[7]||(t[7]=e("thead",{class:"bg-gray-50"},[e("tr",{class:"text-left text-xs font-semibold uppercase tracking-wider text-gray-500"},[e("th",{scope:"col",class:"px-6 py-3"}," Title "),e("th",{scope:"col",class:"px-6 py-3"}," Filename "),e("th",{scope:"col",class:"px-6 py-3"}," Uploaded "),e("th",{scope:"col",class:"px-6 py-3"})])],-1)),e("tbody",Q,[!l.value&&g.value.length===0?(r(),d("tr",R,[...t[6]||(t[6]=[e("td",{colspan:"4",class:"px-6 py-4 text-center text-sm text-gray-500"}," No books found. ",-1)])])):m("",!0),(r(!0),d(C,null,I(g.value,o=>(r(),d("tr",{key:o.id,class:"text-sm text-gray-700"},[e("td",W,[e("div",Y,u(o.title),1)]),e("td",Z,u(o.original_filename??o.filename),1),e("td",ee,u(o.created_at?new Date(o.created_at).toLocaleDateString():"â€”"),1),e("td",te,[e("div",se,[e("button",{onClick:N=>h(E).visit(s.route("books.show",o.id)),class:"rounded-md bg-blue-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-blue-700"}," View ",8,oe),B.value?(r(),d("a",{key:0,href:`/storage/${o.path}`,target:"_blank",class:"rounded-md border border-gray-300 px-3 py-1 text-xs font-semibold text-gray-700 hover:bg-gray-50",onClick:t[1]||(t[1]=D(()=>{},["stop"]))}," Download ",8,le)):m("",!0),e("button",{onClick:D(N=>M(o),["stop"]),class:"rounded-md border border-red-300 px-3 py-1 text-xs font-semibold text-red-600 hover:bg-red-50",disabled:l.value}," Delete ",8,ae)])])]))),128))])])]),a.value?(r(),d("div",ie,[e("div",null," Page "+u(a.value.page)+" of "+u(a.value.totalPages??1),1),e("div",de,[e("button",{onClick:t[2]||(t[2]=o=>b(a.value.page-1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:l.value||a.value.page===1}," Previous ",8,re),e("button",{onClick:t[3]||(t[3]=o=>b(a.value.page+1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:l.value||a.value.page===a.value.totalPages}," Next ",8,ne)])])):m("",!0)])]),e("div",ue,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Upload New Book ",-1)),t[12]||(t[12]=e("p",{class:"mt-1 text-sm text-gray-500"}," Share teaching materials and reference PDFs with staff. ",-1)),e("div",ce,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700"}," Title ",-1)),w(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>i.title=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter book title"},null,512),[[k,i.title]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700"}," PDF File ",-1)),e("input",{ref_key:"fileInput",ref:f,type:"file",accept:".pdf,.doc,.docx,.ppt,.pptx",onChange:F,class:"mt-1 block w-full text-sm text-gray-700"},null,544),t[10]||(t[10]=e("p",{class:"mt-1 text-xs text-gray-500"}," Maximum size 10MB. Supported formats: PDF, DOC(X), PPT(X). ",-1))]),e("button",{type:"button",onClick:S,class:"w-full rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:l.value||!i.title||!i.file}," Upload ",8,pe)])])])])])]),_:1})],64))}};export{be as default};
