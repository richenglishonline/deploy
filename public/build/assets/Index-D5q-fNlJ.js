import{m as N,p as w,r as v,i as B,o as E,c as i,a as c,u as g,h as M,w as p,b as e,d as f,l as A,e as l,F as b,j as k,t as d,v as L,g as C,k as R,f as T}from"./app-Ct4hsfzr.js";import{_ as z}from"./AuthenticatedLayout-D745UfWq.js";import{a as S}from"./api-g2UYsWvT.js";import{_ as G}from"./Button-oQerMwbE.js";import{r as P}from"./PhotoIcon-DaN6h6Ks.js";const O={class:"flex items-center justify-between"},q=["disabled"],H={class:"py-10"},J={class:"mx-auto max-w-7xl space-y-6 px-4 sm:px-6 lg:px-8"},K={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm"},Q={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},W=["value"],X={class:"flex items-end gap-3 sm:col-span-2 lg:col-span-3"},Y=["disabled"],Z=["disabled"],I={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},ee=["onClick"],te={class:"aspect-video bg-gray-100 flex items-center justify-center overflow-hidden"},se=["src","alt"],oe={key:1,class:"flex flex-col items-center justify-center text-gray-400"},ae={class:"p-3"},ie={class:"text-xs font-medium text-gray-900 truncate"},le={class:"text-xs text-gray-500 mt-1"},re={key:0,class:"text-xs text-gray-500 mt-1"},ne={class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity"},de={key:0,class:"text-center py-12"},ue={key:1,class:"flex flex-col items-center justify-between gap-4 border-t border-gray-200 px-6 py-4 text-sm text-gray-600 sm:flex-row"},ce={class:"flex items-center gap-2"},ge=["disabled"],me=["disabled"],ye={__name:"Index",setup(ve){const h=N(),V=w(()=>h.props.auth?.user?.role??"teacher"),$=w(()=>h.props.auth?.user?.id),r=v(!1),m=v([]),a=v(null),x=v([]),n=B({class_id:"",attendance_id:"",page:1,limit:20}),j=async()=>{try{const{data:t}=await S.get("/class",{params:{teacher_id:V.value==="teacher"?$.value:void 0,limit:100}});x.value=t.classes||[]}catch(t){console.error("Error loading filters:",t)}},u=async()=>{r.value=!0;try{const{data:t}=await S.get("/screen-shot",{params:n});m.value=t.screenshots,a.value=t.pagination}catch(t){console.error("Error fetching screenshots:",t)}finally{r.value=!1}},y=t=>{a.value&&(t<1||t>a.value.totalPages||(n.page=t,u()))},U=()=>{n.class_id="",n.attendance_id="",n.page=1,u()},D=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"â€”",_=t=>t.drive?.link?t.drive.link:t.path?`/storage/${t.path}`:null;return E(async()=>{await j(),await u()}),(t,s)=>(l(),i(b,null,[c(g(M),{title:"Screenshots"}),c(z,null,{header:p(()=>[e("div",O,[s[3]||(s[3]=e("div",null,[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Screenshots "),e("p",{class:"text-sm text-gray-500"}," View and manage class screenshots. ")],-1)),e("button",{onClick:u,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:r.value}," Refresh ",8,q)])]),default:p(()=>[e("div",H,[e("div",J,[e("div",K,[e("form",Q,[e("div",null,[s[5]||(s[5]=e("label",{class:"block text-sm font-medium text-gray-700"}," Class ",-1)),A(e("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>n.class_id=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[s[4]||(s[4]=e("option",{value:""},"All Classes",-1)),(l(!0),i(b,null,k(x.value,o=>(l(),i("option",{key:o.id,value:o.id},d(o.student?.name??"Unknown")+" - "+d(o.start_date),9,W))),128))],512),[[L,n.class_id]])]),e("div",X,[e("button",{type:"button",onClick:u,class:"flex-1 rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:r.value}," Apply Filters ",8,Y),e("button",{type:"button",onClick:U,class:"flex-1 rounded-md border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50",disabled:r.value}," Reset ",8,Z)])])]),e("div",I,[(l(!0),i(b,null,k(m.value,o=>(l(),i("div",{key:o.id,class:"group relative overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:F=>g(C).visit(t.route("screenshots.show",o.id))},[e("div",te,[_(o)?(l(),i("img",{key:0,src:_(o),alt:o.filename,class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"},null,8,se)):(l(),i("div",oe,[c(g(P),{class:"h-12 w-12"}),s[6]||(s[6]=e("span",{class:"text-xs mt-2"},"No preview",-1))]))]),e("div",ae,[e("div",ie,d(o.filename??"Untitled Screenshot"),1),e("div",le,d(D(o.created_at)),1),o.classSchedule?(l(),i("div",re,d(o.classSchedule.student?.name??"Unknown"),1)):f("",!0)]),e("div",ne,[c(G,{onClick:R(F=>g(C).visit(t.route("screenshots.show",o.id)),["stop"]),variant:"outline",size:"sm",class:"bg-white/90 backdrop-blur-sm"},{default:p(()=>[...s[7]||(s[7]=[T(" View ",-1)])]),_:1},8,["onClick"])])],8,ee))),128))]),!r.value&&m.value.length===0?(l(),i("div",de,[c(g(P),{class:"mx-auto h-12 w-12 text-gray-400"}),s[8]||(s[8]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No screenshots",-1)),s[9]||(s[9]=e("p",{class:"mt-1 text-sm text-gray-500"},"Get started by uploading a screenshot.",-1))])):f("",!0),a.value&&m.value.length>0?(l(),i("div",ue,[e("div",null," Page "+d(a.value.page)+" of "+d(a.value.totalPages??1),1),e("div",ce,[e("button",{onClick:s[1]||(s[1]=o=>y(a.value.page-1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:r.value||a.value.page===1}," Previous ",8,ge),e("button",{onClick:s[2]||(s[2]=o=>y(a.value.page+1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:r.value||a.value.page===a.value.totalPages}," Next ",8,me)])])):f("",!0)])])]),_:1})],64))}};export{ye as default};
