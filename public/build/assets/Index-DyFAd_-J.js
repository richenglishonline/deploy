import{l as V,m as b,r as u,a as D,o as F,c as l,b as g,u as v,h as $,w as m,d as e,k as A,f as i,F as x,g as w,t as d,v as B,e as _,i as N,n as E}from"./app-DIgTi3sR.js";import{_ as j}from"./AuthenticatedLayout-5E3vSrN1.js";import{a as k}from"./api-Ia4mmZAM.js";import{_ as L}from"./Button-DdUhu-EX.js";import{r as M}from"./VideoCameraIcon-TaHBa-t2.js";const T={class:"flex items-center justify-between"},z=["disabled"],G={class:"py-10"},O={class:"mx-auto max-w-7xl space-y-6 px-4 sm:px-6 lg:px-8"},q={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm"},H={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},J=["value"],K={class:"flex items-end gap-3 sm:col-span-2 lg:col-span-3"},Q=["disabled"],W=["disabled"],X={class:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm"},Y={class:"overflow-x-auto"},Z={class:"min-w-full divide-y divide-gray-200"},I={class:"divide-y divide-gray-200 bg-white"},ee={key:0},se={class:"px-6 py-4"},te={class:"flex items-center gap-2"},oe={class:"font-medium text-gray-900"},ae={key:0,class:"text-xs text-gray-500"},le={class:"px-6 py-4"},ie={key:0},de={class:"font-medium text-gray-900"},ne={class:"text-xs text-gray-500"},re={key:1,class:"text-gray-400"},ce={class:"px-6 py-4"},ue={class:"px-6 py-4"},ge={class:"px-6 py-4"},pe={class:"flex items-center gap-2"},ve={key:0,class:"flex flex-col items-center justify-between gap-4 border-t border-gray-100 px-6 py-4 text-sm text-gray-600 sm:flex-row"},me={class:"flex items-center gap-2"},xe=["disabled"],_e=["disabled"],Se={__name:"Index",setup(ye){const y=V(),C=b(()=>y.props.auth?.user?.role??"teacher"),S=b(()=>y.props.auth?.user?.id),n=u(!1),p=u([]),a=u(null),f=u([]),r=D({class_id:"",attendance_id:"",page:1,limit:20}),U=async()=>{try{const{data:o}=await k.get("/class",{params:{teacher_id:C.value==="teacher"?S.value:void 0,limit:100}});f.value=o.classes||[]}catch(o){console.error("Error loading filters:",o)}},c=async()=>{n.value=!0;try{const{data:o}=await k.get("/recording",{params:r});p.value=o.recordings,a.value=o.pagination}catch(o){console.error("Error fetching recordings:",o)}finally{n.value=!1}},h=o=>{a.value&&(o<1||o>a.value.totalPages||(r.page=o,c()))},P=()=>{r.class_id="",r.attendance_id="",r.page=1,c()},R=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—";return F(async()=>{await U(),await c()}),(o,t)=>(i(),l(x,null,[g(v($),{title:"Recordings"}),g(j,null,{header:m(()=>[e("div",T,[t[3]||(t[3]=e("div",null,[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Recordings "),e("p",{class:"text-sm text-gray-500"}," View and manage class recordings. ")],-1)),e("button",{onClick:c,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:n.value}," Refresh ",8,z)])]),default:m(()=>[e("div",G,[e("div",O,[e("div",q,[e("form",H,[e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700"}," Class ",-1)),A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>r.class_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[t[4]||(t[4]=e("option",{value:""},"All Classes",-1)),(i(!0),l(x,null,w(f.value,s=>(i(),l("option",{key:s.id,value:s.id},d(s.student?.name??"Unknown")+" - "+d(s.start_date),9,J))),128))],512),[[B,r.class_id]])]),e("div",K,[e("button",{type:"button",onClick:c,class:"flex-1 rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:n.value}," Apply Filters ",8,Q),e("button",{type:"button",onClick:P,class:"flex-1 rounded-md border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50",disabled:n.value}," Reset ",8,W)])])]),e("div",X,[e("div",Y,[e("table",Z,[t[8]||(t[8]=e("thead",{class:"bg-gray-50"},[e("tr",{class:"text-left text-xs font-semibold uppercase tracking-wider text-gray-500"},[e("th",{scope:"col",class:"px-6 py-3"}," Recording "),e("th",{scope:"col",class:"px-6 py-3"}," Class "),e("th",{scope:"col",class:"px-6 py-3"}," Uploaded By "),e("th",{scope:"col",class:"px-6 py-3"}," Uploaded At "),e("th",{scope:"col",class:"px-6 py-3"}," Actions ")])],-1)),e("tbody",I,[!n.value&&p.value.length===0?(i(),l("tr",ee,[...t[6]||(t[6]=[e("td",{colspan:"5",class:"px-6 py-4 text-center text-sm text-gray-500"}," No recordings found. ",-1)])])):_("",!0),(i(!0),l(x,null,w(p.value,s=>(i(),l("tr",{key:s.id,class:"text-sm text-gray-700 hover:bg-gray-50"},[e("td",se,[e("div",te,[g(v(M),{class:"h-5 w-5 text-gray-400"}),e("div",null,[e("div",oe,d(s.filename??"Untitled Recording"),1),s.drive?.link?(i(),l("div",ae," Google Drive ")):_("",!0)])])]),e("td",le,[s.classSchedule?(i(),l("div",ie,[e("div",de,d(s.classSchedule.student?.name??"Unknown Student"),1),e("div",ne,d(s.classSchedule.start_date)+" "+d(s.classSchedule.start_time),1)])):(i(),l("span",re,"—"))]),e("td",ce,d(s.uploader?.name??"Unknown"),1),e("td",ue,d(R(s.created_at)),1),e("td",ge,[e("div",pe,[g(L,{onClick:fe=>v(N).visit(o.route("recordings.show",s.id)),variant:"outline",size:"sm"},{default:m(()=>[...t[7]||(t[7]=[E(" View ",-1)])]),_:1},8,["onClick"])])])]))),128))])])]),a.value?(i(),l("div",ve,[e("div",null," Page "+d(a.value.page)+" of "+d(a.value.totalPages??1),1),e("div",me,[e("button",{onClick:t[1]||(t[1]=s=>h(a.value.page-1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:n.value||a.value.page===1}," Previous ",8,xe),e("button",{onClick:t[2]||(t[2]=s=>h(a.value.page+1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:n.value||a.value.page===a.value.totalPages}," Next ",8,_e)])])):_("",!0)])])])]),_:1})],64))}};export{Se as default};
