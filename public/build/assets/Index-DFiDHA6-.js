import{c as _,d as e,g as m,u as R,r as p,o as S,a as r,b as n,h as F,w as l,e as I,f as c,t as o,k as L,F as P,i as $}from"./app-CGuEmW06.js";import{l as V,_ as O}from"./AuthenticatedLayout-CJGuDV3D.js";import{_ as z}from"./AdvancedTable-C74tgwHJ.js";import{_ as J}from"./Button-BBsil_pH.js";import{_ as A}from"./Badge-xK72gQ5Q.js";import{_ as x}from"./Card-O4ACqxyG.js";import{a as b}from"./api-B9gIEsIZ.js";import{r as Z}from"./PlusIcon-CiP_j3xr.js";import{r as q}from"./PencilIcon-C4RcawHT.js";import{r as G}from"./TrashIcon-7rQaTgdF.js";import{r as H}from"./GlobeAltIcon-CfUmYZZP.js";import"./ArrowDownTrayIcon-CC8afiRz.js";import"./ArrowUpIcon-DLRLa_dE.js";function w(j,u){return m(),_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}const K={class:"space-y-6 pb-8"},Q={class:"flex items-center justify-between"},W={class:"grid grid-cols-1 gap-6 sm:grid-cols-3"},X={class:"flex items-center justify-between"},Y={class:"mt-2 text-3xl font-semibold text-gray-900"},ee={class:"rounded-lg bg-blue-50 p-3"},te={class:"flex items-center justify-between"},se={class:"mt-2 text-3xl font-semibold text-gray-900"},ae={class:"rounded-lg bg-green-50 p-3"},re={class:"flex items-center justify-between"},le={class:"mt-2 text-3xl font-semibold text-gray-900"},ne={class:"rounded-lg bg-purple-50 p-3"},oe={class:"flex items-center gap-3"},ie={class:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-purple-600"},de={class:"text-sm font-semibold text-white"},ce={class:"font-medium text-gray-900"},me={key:0,class:"text-xs text-gray-500"},ue={class:"flex items-center gap-2 text-gray-900"},pe={class:"flex items-center gap-2 text-gray-900"},_e={class:"flex items-center justify-end gap-2"},ge=["onClick"],fe=["onClick"],he={key:1,class:"space-y-4"},Ue={__name:"Index",setup(j){R();const u=p(!1),d=p([]);p("");const g=p([]),f=[{key:"name",label:"Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"country",label:"Country",sortable:!0},{key:"timezone",label:"Timezone",sortable:!0},{key:"created_at",label:"Joined",sortable:!0,format:"date"},{key:"assigned_teachers_count",label:"Assigned Teachers",sortable:!0,align:"center"}],C=[{key:"country",label:"Country",type:"select",options:[{value:"",label:"All Countries"},{value:"Philippines",label:"Philippines"},{value:"USA",label:"USA"},{value:"India",label:"India"}]}],h=async()=>{u.value=!0;try{const{data:a}=await b.get("/teacher",{params:{role:"admin"}});d.value=Array.isArray(a)?a.map(t=>({...t,name:`${t.first_name||""} ${t.last_name||""}`.trim()||t.email,assigned_teachers_count:t.assigned_teachers?.length||0})):[]}catch(a){console.error("Error fetching admins:",a),d.value=[]}finally{u.value=!1}},E=a=>{$.visit(`/super-admin/admins/${a.id}`)},B=async a=>{if(confirm(`Are you sure you want to delete ${a.name}?`))try{await b.delete(`/teacher/${a.id}`),await h()}catch(t){console.error("Error deleting admin:",t),alert("Failed to delete admin")}},T=async()=>{if(confirm(`Are you sure you want to delete ${g.value.length} admin(s)?`))try{await Promise.all(g.value.map(a=>b.delete(`/teacher/${a.id}`))),g.value=[],await h()}catch(a){console.error("Error bulk deleting admins:",a),alert("Failed to delete some admins")}},U=a=>{const t=f.map(v=>v.label).join(","),s=a.map(v=>f.map(N=>`"${v[N.key]||""}"`).join(",")).join(`
`),i=`${t}
${s}`,M=new Blob([i],{type:"text/csv"}),k=window.URL.createObjectURL(M),y=document.createElement("a");y.href=k,y.download=`admins-${new Date().toISOString().split("T")[0]}.csv`,y.click(),window.URL.revokeObjectURL(k)},D=()=>{$.visit("/super-admin/admins/create")};return S(()=>{h()}),(a,t)=>(m(),_(P,null,[r(n(F),{title:"Admins Management"}),r(O,null,{default:l(()=>[e("div",K,[e("div",Q,[t[1]||(t[1]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Admins Management"),e("p",{class:"mt-1 text-sm text-gray-500"}," Manage system administrators and their permissions ")],-1)),r(J,{onClick:D,variant:"primary"},{default:l(()=>[r(n(Z),{class:"h-5 w-5 mr-2"}),t[0]||(t[0]=c(" Add Admin ",-1))]),_:1})]),e("div",W,[r(x,{class:"p-6"},{default:l(()=>[e("div",X,[e("div",null,[t[2]||(t[2]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Admins",-1)),e("p",Y,o(d.value.length),1)]),e("div",ee,[r(n(w),{class:"h-8 w-8 text-blue-600"})])])]),_:1}),r(x,{class:"p-6"},{default:l(()=>[e("div",te,[e("div",null,[t[3]||(t[3]=e("p",{class:"text-sm font-medium text-gray-600"},"Active Admins",-1)),e("p",se,o(d.value.filter(s=>s.accepted).length),1)]),e("div",ae,[r(n(w),{class:"h-8 w-8 text-green-600"})])])]),_:1}),r(x,{class:"p-6"},{default:l(()=>[e("div",re,[e("div",null,[t[4]||(t[4]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Assigned Teachers",-1)),e("p",le,o(d.value.reduce((s,i)=>s+(i.assigned_teachers_count||0),0)),1)]),e("div",ne,[r(n(w),{class:"h-8 w-8 text-purple-600"})])])]),_:1})]),u.value?(m(),_("div",he,[...t[5]||(t[5]=[e("div",{class:"h-64 rounded-xl bg-gray-200 animate-pulse"},null,-1)])])):(m(),I(z,{key:0,title:"All Admins",columns:f,data:d.value,searchable:!0,paginated:!0,selectable:!0,exportable:!0,filters:C,"items-per-page":25,"row-key":"id",onExport:U,onBulkDelete:T},{"cell-name":l(({row:s})=>[e("div",oe,[e("div",ie,[e("span",de,o(s.name.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2)),1)]),e("div",null,[e("div",ce,o(s.name),1),s.role?(m(),_("div",me,[r(A,{variant:s.role==="super-admin"?"primary":"secondary"},{default:l(()=>[c(o(s.role),1)]),_:2},1032,["variant"])])):L("",!0)])])]),"cell-email":l(({row:s})=>[e("div",ue,[r(n(V),{class:"h-4 w-4 text-gray-400"}),c(" "+o(s.email),1)])]),"cell-country":l(({row:s})=>[e("div",pe,[r(n(H),{class:"h-4 w-4 text-gray-400"}),c(" "+o(s.country||"â€”"),1)])]),"cell-assigned_teachers_count":l(({row:s})=>[r(A,{variant:"secondary"},{default:l(()=>[c(o(s.assigned_teachers_count||0),1)]),_:2},1024)]),"row-actions":l(({row:s})=>[e("div",_e,[e("button",{onClick:i=>E(s),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-blue-600 transition-colors",title:"Edit"},[r(n(q),{class:"h-5 w-5"})],8,ge),e("button",{onClick:i=>B(s),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-red-600 transition-colors",title:"Delete"},[r(n(G),{class:"h-5 w-5"})],8,fe)])]),_:1},8,["data"]))])]),_:1})],64))}};export{Ue as default};
