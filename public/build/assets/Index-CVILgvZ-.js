import{r as y,m as B,j as L,o as M,c as u,a as i,b as E,h as I,w as n,d as t,s as Y,f as r,p as O,g as d,F as w,q as R,t as a,x as U,k as c,y as q,e as H}from"./app-BiSPCPuo.js";import{_ as W}from"./AuthenticatedLayout-57Q77M7z.js";import{_ as v}from"./Button-cwC7HEN4.js";import{_ as N,a as G}from"./Label-B-UqCD74.js";import{_ as J,a as K,b as Q,c as X,d as Z}from"./DialogFooter-2j7boOhP.js";import{a as P}from"./api-BtR7IrG5.js";import"./utils-5sbMIizx.js";const ee={class:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},te={class:"flex items-center gap-2"},se={class:"py-10"},le={class:"mx-auto max-w-7xl space-y-6 px-4 sm:px-6 lg:px-8"},ae={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm"},oe={class:"space-y-2"},re={class:"space-y-2"},ie=["value"],ne={class:"flex items-end gap-3 sm:col-span-2 lg:col-span-1"},de={class:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm"},ue={class:"overflow-x-auto"},pe={class:"min-w-full divide-y divide-gray-200"},ce={class:"divide-y divide-gray-200 bg-white"},ve={key:0},fe={class:"px-6 py-4 align-top"},me={class:"font-medium text-gray-900"},_e={class:"text-gray-500"},xe={class:"text-xs text-gray-400"},ge={class:"px-6 py-4 align-top"},ye={class:"space-y-1"},be={class:"space-x-2 text-xs"},he=["href"],ke=["href"],we=["href"],Ae={class:"px-6 py-4 align-top"},je={class:"px-6 py-4 align-top"},$e={class:"px-6 py-4 align-top"},Ce={class:"flex flex-wrap items-center gap-2"},Se={key:0,class:"flex flex-col items-center justify-between gap-4 border-t border-gray-100 px-6 py-4 text-sm text-gray-600 sm:flex-row"},Re={class:"flex items-center gap-2"},Ne={key:0,class:"space-y-4 overflow-y-auto pr-2"},Pe={class:"space-y-1"},Ve={class:"text-sm text-gray-600"},ze={class:"text-xs text-gray-500"},De={class:"space-y-2"},Fe={class:"grid grid-cols-1 gap-2 sm:grid-cols-2"},Te={class:"text-sm text-gray-700"},Be={class:"text-sm text-gray-700"},Le={class:"text-sm text-gray-700"},Me={class:"text-sm text-gray-700"},Ee={class:"mt-1 whitespace-pre-line text-sm text-gray-700"},Ie={class:"mt-1 whitespace-pre-line text-sm text-gray-700"},Ye={class:"space-y-2"},Oe={class:"grid grid-cols-1 gap-2 text-sm text-gray-700 sm:grid-cols-2"},Ue={class:"font-medium"},qe={class:"font-medium"},He={class:"font-medium"},We={class:"font-medium"},Ge={class:"space-y-2"},Je={class:"flex flex-wrap gap-3 text-sm"},Ke=["href"],Qe=["href"],Xe=["href"],Ze={key:0,class:"space-y-1"},et={class:"whitespace-pre-line text-sm text-gray-700"},tt={class:"text-xs text-gray-500"},st={class:"flex items-center gap-2"},pt={__name:"Index",setup(lt){const f=y(!1),k=y([]),p=y(null),b=y(!1),l=y(null),_=y(null),m=B({search:"",status:"pending",page:1,limit:10}),V=[{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"}],z=L(()=>!f.value&&k.value.length>0),x=async()=>{f.value=!0;try{const{data:o}=await P.get("/teacher-applications",{params:{...m}});k.value=o.applications,p.value=o.pagination}catch(o){console.error("Failed to fetch applications:",o),alert("Failed to load teacher applications.")}finally{f.value=!1}},A=o=>{p.value&&(o<1||o>p.value.totalPages||(m.page=o,x()))},D=()=>{m.search="",m.status="pending",m.page=1,x()},F=o=>{l.value=o,b.value=!0},g=o=>{const e=o.meta?.teacher_application_status;return e==="approved"?"Approved":e==="rejected"?"Rejected":o.accepted?"Approved":"Pending"},j=o=>{if(!o)return"—";try{return new Date(o).toLocaleString()}catch{return o}},$=async(o,e,s="")=>{if(!_.value){_.value=o.id;try{await P.patch(`/teacher-applications/${o.id}`,{status:e,notes:s}),alert(`Application ${e==="approved"?"approved":e==="rejected"?"rejected":"updated"}.`),await x(),b.value=!1}catch(h){console.error("Failed to update status:",h);const T=h.response?.data?.message||"Failed to update application status.";alert(T)}finally{_.value=null}}},C=o=>{confirm(`Approve ${o.name}'s application?`)&&$(o,"approved")},S=o=>{const e=prompt(`Optional: add notes for rejecting ${o.name}. Leave blank to skip.`);e!==null&&confirm(`Reject ${o.name}'s application?`)&&$(o,"rejected",e)};return M(x),(o,e)=>(d(),u(w,null,[i(E(I),{title:"Teacher Applications"}),i(W,null,{header:n(()=>[t("div",ee,[e[9]||(e[9]=t("div",null,[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Teacher Applications "),t("p",{class:"text-sm text-gray-500"}," Review, approve, or reject teacher applications submitted from the public apply page. ")],-1)),t("div",te,[i(v,{variant:"outline",disabled:f.value,onClick:x},{default:n(()=>[...e[8]||(e[8]=[r(" Refresh ",-1)])]),_:1},8,["disabled"])])])]),default:n(()=>[t("div",se,[t("div",le,[t("div",ae,[t("form",{class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",onSubmit:Y(x,["prevent"])},[t("div",oe,[i(N,null,{default:n(()=>[...e[10]||(e[10]=[r("Search",-1)])]),_:1}),i(G,{modelValue:m.search,"onUpdate:modelValue":e[0]||(e[0]=s=>m.search=s),type:"text",placeholder:"Name or email"},null,8,["modelValue"])]),t("div",re,[i(N,null,{default:n(()=>[...e[11]||(e[11]=[r("Status",-1)])]),_:1}),O(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>m.status=s),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"},[(d(),u(w,null,R(V,s=>t("option",{key:s.value,value:s.value},a(s.label),9,ie)),64))],512),[[U,m.status]])]),t("div",ne,[i(v,{type:"submit",class:"flex-1",disabled:f.value},{default:n(()=>[...e[12]||(e[12]=[r(" Apply Filters ",-1)])]),_:1},8,["disabled"]),i(v,{type:"button",variant:"outline",class:"flex-1",disabled:f.value,onClick:D},{default:n(()=>[...e[13]||(e[13]=[r(" Reset ",-1)])]),_:1},8,["disabled"])])],32)]),t("div",de,[t("div",ue,[t("table",pe,[e[22]||(e[22]=t("thead",{class:"bg-gray-50"},[t("tr",{class:"text-left text-xs font-semibold uppercase tracking-wider text-gray-500"},[t("th",{scope:"col",class:"px-6 py-3"},"Applicant"),t("th",{scope:"col",class:"px-6 py-3"},"Profile"),t("th",{scope:"col",class:"px-6 py-3"},"Submitted"),t("th",{scope:"col",class:"px-6 py-3"},"Status"),t("th",{scope:"col",class:"px-6 py-3"},"Actions")])],-1)),t("tbody",ce,[!f.value&&!z.value?(d(),u("tr",ve,[...e[14]||(e[14]=[t("td",{colspan:"5",class:"px-6 py-8 text-center text-sm text-gray-500"}," No applications found for the selected filters. ",-1)])])):c("",!0),(d(!0),u(w,null,R(k.value,s=>(d(),u("tr",{key:s.id,class:"text-sm text-gray-700"},[t("td",fe,[t("div",me,a(s.name),1),t("div",_e,a(s.email),1),t("div",xe,a(s.country??"—"),1)]),t("td",ge,[t("div",ye,[t("div",null,[e[15]||(e[15]=t("span",{class:"font-medium"},"Degree:",-1)),r(" "+a(s.teacher_profile?.degree??"—"),1)]),t("div",null,[e[16]||(e[16]=t("span",{class:"font-medium"},"Major:",-1)),r(" "+a(s.teacher_profile?.major??"—"),1)]),t("div",null,[e[17]||(e[17]=t("span",{class:"font-medium"},"English Level:",-1)),r(" "+a(s.teacher_profile?.english_level??"—"),1)]),t("div",null,[e[18]||(e[18]=t("span",{class:"font-medium"},"Availability:",-1)),r(" "+a(s.teacher_profile?.availability??"—"),1)]),t("div",be,[s.teacher_profile?.resume_url?(d(),u("a",{key:0,href:s.teacher_profile.resume_url,target:"_blank",rel:"noopener",class:"text-blue-600 hover:underline"}," Resume ",8,he)):c("",!0),s.teacher_profile?.intro_video_url?(d(),u("a",{key:1,href:s.teacher_profile.intro_video_url,target:"_blank",rel:"noopener",class:"text-blue-600 hover:underline"}," Intro Video ",8,ke)):c("",!0),s.teacher_profile?.speed_test_screenshot_url?(d(),u("a",{key:2,href:s.teacher_profile.speed_test_screenshot_url,target:"_blank",rel:"noopener",class:"text-blue-600 hover:underline"}," Speed Test ",8,we)):c("",!0)])])]),t("td",Ae,a(j(s.created_at)),1),t("td",je,[t("span",{class:q(["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",g(s)==="Approved"?"bg-green-100 text-green-700":g(s)==="Rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"])},a(g(s)),3)]),t("td",$e,[t("div",Ce,[i(v,{variant:"outline",size:"sm",onClick:h=>F(s)},{default:n(()=>[...e[19]||(e[19]=[r(" View ",-1)])]),_:1},8,["onClick"]),i(v,{size:"sm",disabled:_.value===s.id||g(s)==="Approved",onClick:h=>C(s)},{default:n(()=>[...e[20]||(e[20]=[r(" Approve ",-1)])]),_:1},8,["disabled","onClick"]),i(v,{variant:"destructive",size:"sm",disabled:_.value===s.id||g(s)==="Rejected",onClick:h=>S(s)},{default:n(()=>[...e[21]||(e[21]=[r(" Reject ",-1)])]),_:1},8,["disabled","onClick"])])])]))),128))])])]),p.value?(d(),u("div",Se,[t("div",null," Page "+a(p.value.page)+" of "+a(p.value.totalPages??1),1),t("div",Re,[i(v,{variant:"outline",size:"sm",disabled:f.value||p.value.page===1,onClick:e[2]||(e[2]=s=>A(p.value.page-1))},{default:n(()=>[...e[23]||(e[23]=[r(" Previous ",-1)])]),_:1},8,["disabled"]),i(v,{variant:"outline",size:"sm",disabled:f.value||p.value.page===p.value.totalPages,onClick:e[3]||(e[3]=s=>A(p.value.page+1))},{default:n(()=>[...e[24]||(e[24]=[r(" Next ",-1)])]),_:1},8,["disabled"])])])):c("",!0)])])]),i(J,{open:b.value,"onUpdate:open":e[7]||(e[7]=s=>b.value=s)},{default:n(()=>[i(K,null,{default:n(()=>[i(Q,null,{default:n(()=>[...e[25]||(e[25]=[r("Application Details",-1)])]),_:1}),l.value?(d(),H(X,{key:0},{default:n(()=>[r(" Submitted "+a(j(l.value.created_at)),1)]),_:1})):c("",!0)]),_:1}),l.value?(d(),u("div",Ne,[t("section",Pe,[e[26]||(e[26]=t("h3",{class:"text-sm font-semibold text-gray-700"},"Applicant",-1)),t("p",Ve,a(l.value.name)+" · "+a(l.value.email),1),t("p",ze," Country: "+a(l.value.country??"—")+" | Timezone: "+a(l.value.timezone??"—"),1)]),t("section",De,[e[33]||(e[33]=t("h3",{class:"text-sm font-semibold text-gray-700"},"Profile",-1)),t("div",Fe,[t("div",null,[e[27]||(e[27]=t("span",{class:"text-xs uppercase text-gray-500"},"Degree",-1)),t("div",Te,a(l.value.teacher_profile?.degree??"—"),1)]),t("div",null,[e[28]||(e[28]=t("span",{class:"text-xs uppercase text-gray-500"},"Major",-1)),t("div",Be,a(l.value.teacher_profile?.major??"—"),1)]),t("div",null,[e[29]||(e[29]=t("span",{class:"text-xs uppercase text-gray-500"},"English Level",-1)),t("div",Le,a(l.value.teacher_profile?.english_level??"—"),1)]),t("div",null,[e[30]||(e[30]=t("span",{class:"text-xs uppercase text-gray-500"},"Availability",-1)),t("div",Me,a(l.value.teacher_profile?.availability??"—"),1)])]),t("div",null,[e[31]||(e[31]=t("span",{class:"text-xs uppercase text-gray-500"},"Experience",-1)),t("p",Ee,a(l.value.teacher_profile?.experience??"—"),1)]),t("div",null,[e[32]||(e[32]=t("span",{class:"text-xs uppercase text-gray-500"},"Motivation",-1)),t("p",Ie,a(l.value.teacher_profile?.motivation??"—"),1)])]),t("section",Ye,[e[38]||(e[38]=t("h3",{class:"text-sm font-semibold text-gray-700"},"Equipment",-1)),t("ul",Oe,[t("li",null,[e[34]||(e[34]=r("Webcam: ",-1)),t("span",Ue,a(l.value.teacher_profile?.has_webcam?"Yes":"No"),1)]),t("li",null,[e[35]||(e[35]=r("Headset: ",-1)),t("span",qe,a(l.value.teacher_profile?.has_headset?"Yes":"No"),1)]),t("li",null,[e[36]||(e[36]=r("Backup Internet: ",-1)),t("span",He,a(l.value.teacher_profile?.has_backup_internet?"Yes":"No"),1)]),t("li",null,[e[37]||(e[37]=r("Backup Power: ",-1)),t("span",We,a(l.value.teacher_profile?.has_backup_power?"Yes":"No"),1)])])]),t("section",Ge,[e[39]||(e[39]=t("h3",{class:"text-sm font-semibold text-gray-700"},"Attachments",-1)),t("div",Je,[l.value.teacher_profile?.resume_url?(d(),u("a",{key:0,href:l.value.teacher_profile.resume_url,target:"_blank",rel:"noopener",class:"text-blue-600 hover:underline"}," Resume ",8,Ke)):c("",!0),l.value.teacher_profile?.intro_video_url?(d(),u("a",{key:1,href:l.value.teacher_profile.intro_video_url,target:"_blank",rel:"noopener",class:"text-blue-600 hover:underline"}," Intro Video ",8,Qe)):c("",!0),l.value.teacher_profile?.speed_test_screenshot_url?(d(),u("a",{key:2,href:l.value.teacher_profile.speed_test_screenshot_url,target:"_blank",rel:"noopener",class:"text-blue-600 hover:underline"}," Speed Test ",8,Xe)):c("",!0)])]),l.value.meta?.teacher_application_notes?(d(),u("section",Ze,[e[40]||(e[40]=t("h3",{class:"text-sm font-semibold text-gray-700"},"Reviewer Notes",-1)),t("p",et,a(l.value.meta.teacher_application_notes),1)])):c("",!0)])):c("",!0),i(Z,{class:"flex items-center justify-between gap-2"},{default:n(()=>[t("div",tt," Status: "+a(g(l.value??{})),1),t("div",st,[i(v,{variant:"outline",onClick:e[4]||(e[4]=s=>b.value=!1)},{default:n(()=>[...e[41]||(e[41]=[r(" Close ",-1)])]),_:1}),i(v,{disabled:!l.value||_.value===l.value.id,onClick:e[5]||(e[5]=s=>C(l.value))},{default:n(()=>[...e[42]||(e[42]=[r(" Approve ",-1)])]),_:1},8,["disabled"]),i(v,{variant:"destructive",disabled:!l.value||_.value===l.value.id,onClick:e[6]||(e[6]=s=>S(l.value))},{default:n(()=>[...e[43]||(e[43]=[r(" Reject ",-1)])]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"])]),_:1})],64))}};export{pt as default};
