import{u as A,r as x,j as b,o as B,c as v,a as o,b as n,h as H,w as r,d as t,e as R,f as M,t as l,g as f,F as N,i as F}from"./app-Cmmq__Tw.js";import{b as P,j as O,d as V,k as I,_ as J}from"./AuthenticatedLayout-B2GbnFPi.js";import{_ as W}from"./AdvancedTable-CIaIA73U.js";import{_ as u}from"./Card-CcoMGp7w.js";import{_ as q}from"./Button-D72KtQR-.js";import{a as w}from"./api-BS-ONIJM.js";import{r as z}from"./PlusIcon-3lCZdoOe.js";import{r as G}from"./PencilIcon-BCql_y0B.js";import"./ArrowDownTrayIcon-CzbVfJHZ.js";import"./ArrowUpIcon-DRFX-h9Y.js";import"./TrashIcon-DD0p8Ace.js";const K={class:"space-y-6 pb-8"},Q={class:"flex items-center justify-between"},X={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},Y={class:"flex items-center justify-between"},Z={class:"mt-2 text-3xl font-semibold text-gray-900"},tt={class:"rounded-lg bg-blue-50 p-3"},et={class:"flex items-center justify-between"},at={class:"mt-2 text-3xl font-semibold text-gray-900"},st={class:"rounded-lg bg-green-50 p-3"},rt={class:"flex items-center justify-between"},ot={class:"mt-2 text-3xl font-semibold text-gray-900"},lt={class:"rounded-lg bg-purple-50 p-3"},it={class:"flex items-center justify-between"},nt={class:"mt-2 text-3xl font-semibold text-gray-900"},ct={class:"rounded-lg bg-orange-50 p-3"},dt={class:"flex items-center gap-3"},ut={class:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-indigo-500 to-purple-600"},mt={class:"text-sm font-semibold text-white"},pt={class:"font-medium text-gray-900"},gt={class:"text-right font-medium text-gray-900"},_t={class:"text-center font-medium text-gray-900"},xt={class:"text-right font-medium text-gray-900"},ft={class:"text-right font-medium text-green-600"},yt={class:"text-right font-semibold text-gray-900"},ht={class:"text-gray-900"},bt=["onClick"],vt={key:1,class:"space-y-4"},At={__name:"Index",setup(Ft){A();const m=x(!1),i=x([]),$=x(null),p=[{key:"teacher",label:"Teacher",sortable:!0},{key:"rate_per_hour",label:"Rate/Hour",sortable:!0,format:"currency",align:"right"},{key:"total_hours",label:"Total Hours",sortable:!0,align:"center",format:"number"},{key:"base_salary",label:"Base Salary",sortable:!0,format:"currency",align:"right"},{key:"bonus",label:"Bonus",sortable:!0,format:"currency",align:"right"},{key:"total_salary",label:"Total Salary",sortable:!0,format:"currency",align:"right"},{key:"period",label:"Period",sortable:!0}],k=[{key:"period",label:"Period",type:"select",options:[{value:"",label:"All Periods"},{value:"2025-01",label:"January 2025"},{value:"2025-02",label:"February 2025"},{value:"2025-03",label:"March 2025"}]}],S=async()=>{m.value=!0;try{const{data:s}=await w.get("/salary");i.value=Array.isArray(s.salaries||s)?(s.salaries||s).map(e=>({...e,teacher:e.teacher?`${e.teacher.first_name||""} ${e.teacher.last_name||""}`.trim()||e.teacher.email:"N/A",total_salary:(parseFloat(e.base_salary||0)+parseFloat(e.bonus||0)).toFixed(2),period:e.period||`${e.start_date} - ${e.end_date}`})):[]}catch(s){console.error("Error fetching salaries:",s),i.value=[]}finally{m.value=!1}},j=async()=>{try{const{data:s}=await w.get("/dashboard/stats");$.value=s?.stats||{}}catch(s){console.error("Error fetching stats:",s)}},D=()=>{F.visit("/super-admin/salary/create")},T=s=>{F.visit(`/super-admin/salary/${s.id}/edit`)},U=b(()=>i.value.reduce((s,e)=>s+parseFloat(e.total_salary||0),0).toFixed(2)),C=b(()=>i.value.reduce((s,e)=>s+parseFloat(e.total_hours||0),0).toFixed(2)),E=s=>{const e=p.map(_=>_.label).join(","),a=s.map(_=>p.map(h=>{let d=_[h.key]||"";return h.format==="currency"&&(d=typeof d=="number"?d:parseFloat(d)||0),`"${String(d).replace(/"/g,'""')}"`}).join(",")).join(`
`),c=`${e}
${a}`,L=new Blob([c],{type:"text/csv"}),y=window.URL.createObjectURL(L),g=document.createElement("a");g.href=y,g.download=`salaries-${new Date().toISOString().split("T")[0]}.csv`,g.click(),window.URL.revokeObjectURL(y)};return B(()=>{S(),j()}),(s,e)=>(f(),v(N,null,[o(n(H),{title:"Salary Management"}),o(J,null,{default:r(()=>[t("div",K,[t("div",Q,[e[1]||(e[1]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"Salary Management"),t("p",{class:"mt-1 text-sm text-gray-500"}," Manage teacher salaries and compensation ")],-1)),o(q,{onClick:D,variant:"primary"},{default:r(()=>[o(n(z),{class:"h-5 w-5 mr-2"}),e[0]||(e[0]=M(" Configure Salary ",-1))]),_:1})]),t("div",X,[o(u,{class:"p-6"},{default:r(()=>[t("div",Y,[t("div",null,[e[2]||(e[2]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Teachers",-1)),t("p",Z,l(i.value.length),1),e[3]||(e[3]=t("p",{class:"mt-1 text-xs text-gray-500"},"With salary config",-1))]),t("div",tt,[o(n(P),{class:"h-8 w-8 text-blue-600"})])])]),_:1}),o(u,{class:"p-6"},{default:r(()=>[t("div",et,[t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Salary",-1)),t("p",at," $"+l(U.value.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1),e[5]||(e[5]=t("p",{class:"mt-1 text-xs text-gray-500"},"This period",-1))]),t("div",st,[o(n(O),{class:"h-8 w-8 text-green-600"})])])]),_:1}),o(u,{class:"p-6"},{default:r(()=>[t("div",rt,[t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Hours",-1)),t("p",ot,l(C.value)+"h ",1),e[7]||(e[7]=t("p",{class:"mt-1 text-xs text-gray-500"},"Hours worked",-1))]),t("div",lt,[o(n(V),{class:"h-8 w-8 text-purple-600"})])])]),_:1}),o(u,{class:"p-6"},{default:r(()=>[t("div",it,[t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm font-medium text-gray-600"},"Avg Rate/Hour",-1)),t("p",nt," $"+l(i.value.length>0?(i.value.reduce((a,c)=>a+parseFloat(c.rate_per_hour||0),0)/i.value.length).toFixed(2):"0.00"),1),e[9]||(e[9]=t("p",{class:"mt-1 text-xs text-gray-500"},"Average",-1))]),t("div",ct,[o(n(I),{class:"h-8 w-8 text-orange-600"})])])]),_:1})]),m.value?(f(),v("div",vt,[...e[10]||(e[10]=[t("div",{class:"h-64 rounded-xl bg-gray-200 animate-pulse"},null,-1)])])):(f(),R(W,{key:0,title:"All Salary Configurations",columns:p,data:i.value,searchable:!0,paginated:!0,exportable:!0,filters:k,"items-per-page":25,"row-key":"id",onExport:E},{"cell-teacher":r(({row:a})=>[t("div",dt,[t("div",ut,[t("span",mt,l(a.teacher.split(" ").map(c=>c[0]).join("").toUpperCase().slice(0,2)),1)]),t("span",pt,l(a.teacher),1)])]),"cell-rate_per_hour":r(({row:a})=>[t("div",gt," $"+l(parseFloat(a.rate_per_hour||0).toFixed(2)),1)]),"cell-total_hours":r(({row:a})=>[t("div",_t,l(parseFloat(a.total_hours||0).toFixed(2))+"h ",1)]),"cell-base_salary":r(({row:a})=>[t("div",xt," $"+l(parseFloat(a.base_salary||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),"cell-bonus":r(({row:a})=>[t("div",ft," +$"+l(parseFloat(a.bonus||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),"cell-total_salary":r(({row:a})=>[t("div",yt," $"+l(parseFloat(a.total_salary||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1)]),"cell-period":r(({row:a})=>[t("div",ht,l(a.period||"â€”"),1)]),"row-actions":r(({row:a})=>[t("button",{onClick:c=>T(a),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-blue-600 transition-colors",title:"Edit"},[o(n(G),{class:"h-5 w-5"})],8,bt)]),_:1},8,["data"]))])]),_:1})],64))}};export{At as default};
