import{c as r,b as t,e as o,m as j,p as R,r as b,i as P,o as $,a as c,u as f,h as z,w as T,d as y,l as g,F as i,j as x,t as a,v as C,s as V,f as A,n as N,q as H}from"./app-Ct4hsfzr.js";import{c as U,_ as I}from"./AuthenticatedLayout-D745UfWq.js";import{a as h}from"./api-g2UYsWvT.js";import{_ as L}from"./Button-oQerMwbE.js";function O(B,_){return o(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}const q={class:"flex items-center justify-between"},Z={class:"flex items-center gap-2"},J=["disabled"],K={class:"py-10"},Q={class:"mx-auto max-w-7xl space-y-6 px-4 sm:px-6 lg:px-8"},W={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm"},X={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},Y=["value"],tt={key:0},et=["value"],st=["value"],at={class:"flex items-end gap-3 sm:col-span-2 lg:col-span-4"},ot=["disabled"],lt=["disabled"],rt={key:0,class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm"},dt={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},nt={class:"text-sm font-medium text-gray-500 capitalize"},it={class:"mt-1 text-2xl font-semibold text-gray-900"},ut={key:1,class:"rounded-lg border border-gray-200 bg-white shadow-sm"},pt={class:"border-b border-gray-200 px-6 py-4"},yt={class:"text-lg font-semibold text-gray-900"},ct={class:"text-sm font-normal text-gray-500"},gt={class:"overflow-x-auto"},xt={class:"min-w-full divide-y divide-gray-200"},mt={class:"bg-gray-50"},vt={class:"text-left text-xs font-semibold uppercase tracking-wider text-gray-500"},bt={class:"divide-y divide-gray-200 bg-white"},ft={class:"px-6 py-4"},ht={class:"px-6 py-4"},_t={class:"px-6 py-4"},wt={class:"px-6 py-4"},kt={class:"px-6 py-4"},Rt={class:"px-6 py-4"},Tt={class:"px-6 py-4"},Ct={class:"px-6 py-4"},Dt={class:"px-6 py-4"},St={class:"px-6 py-4"},Vt={class:"px-6 py-4"},At={class:"px-6 py-4"},Nt={class:"px-6 py-4"},Ut={class:"px-6 py-4"},Bt={class:"px-6 py-4"},Et={class:"px-6 py-4"},Gt={class:"px-6 py-4"},Ft={class:"px-6 py-4"},Mt={class:"px-6 py-4"},jt={key:2,class:"text-center py-12"},Pt={key:3,class:"text-center py-12"},Lt={__name:"Index",setup(B){const _=j(),p=R(()=>_.props.auth?.user?.role??"teacher"),w=R(()=>_.props.auth?.user?.id),u=b(!1),l=b(null),D=b([]),k=b([]),d=P({type:(p.value==="teacher","attendance"),start_date:"",end_date:"",teacher_id:p.value==="teacher"?w.value:"",student_id:""}),E=R(()=>p.value==="teacher"?[{value:"attendance",label:"Attendance Report"},{value:"classes",label:"Classes Report"}]:[{value:"attendance",label:"Attendance Report"},{value:"classes",label:"Classes Report"},{value:"payouts",label:"Payouts Report"},{value:"students",label:"Students Report"}]),G=async()=>{try{if(p.value!=="teacher"){const[n,e]=await Promise.all([h.get("/dashboard/teachers"),h.get("/dashboard/students")]);D.value=n.data,k.value=e.data}else{const n=await h.get("/dashboard/students");k.value=n.data}}catch(n){console.error("Error loading filters:",n)}},S=async()=>{u.value=!0;try{const n={...d};p.value==="teacher"&&(n.teacher_id=w.value);const{data:e}=await h.get("/reports",{params:n});l.value=e}catch(n){console.error("Error generating report:",n)}finally{u.value=!1}},F=()=>{d.type=(p.value==="teacher","attendance"),d.start_date="",d.end_date="",d.teacher_id=p.value==="teacher"?w.value:"",d.student_id="",l.value=null},m=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—",M=()=>{alert("Export functionality coming soon")};return $(G),(n,e)=>(o(),r(i,null,[c(f(z),{title:"Reports"}),c(I,null,{header:T(()=>[t("div",q,[e[6]||(e[6]=t("div",null,[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Reports "),t("p",{class:"text-sm text-gray-500"}," Generate and view reports based on your data. ")],-1)),t("div",Z,[l.value?(o(),H(L,{key:0,onClick:M,variant:"outline",disabled:u.value},{default:T(()=>[c(f(O),{class:"h-4 w-4 mr-2"}),e[5]||(e[5]=A(" Export ",-1))]),_:1},8,["disabled"])):y("",!0),t("button",{onClick:S,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:u.value},a(u.value?"Generating...":"Generate Report"),9,J)])])]),default:T(()=>[t("div",K,[t("div",Q,[t("div",W,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Report Filters",-1)),t("form",X,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700"}," Report Type ",-1)),g(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>d.type=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[(o(!0),r(i,null,x(E.value,s=>(o(),r("option",{key:s.value,value:s.value},a(s.label),9,Y))),128))],512),[[C,d.type]])]),p.value!=="teacher"?(o(),r("div",tt,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700"}," Teacher ",-1)),g(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>d.teacher_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[e[8]||(e[8]=t("option",{value:""},"All Teachers",-1)),(o(!0),r(i,null,x(D.value,s=>(o(),r("option",{key:s.id,value:s.id},a(s.name),9,et))),128))],512),[[C,d.teacher_id]])])):y("",!0),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700"}," Student ",-1)),g(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>d.student_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[e[10]||(e[10]=t("option",{value:""},"All Students",-1)),(o(!0),r(i,null,x(k.value,s=>(o(),r("option",{key:s.id,value:s.id},a(s.name),9,st))),128))],512),[[C,d.student_id]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"}," Start Date ",-1)),g(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>d.start_date=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[V,d.start_date]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700"}," End Date ",-1)),g(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>d.end_date=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[V,d.end_date]])]),t("div",at,[t("button",{type:"button",onClick:S,class:"flex-1 rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:u.value},a(u.value?"Generating...":"Generate Report"),9,ot),t("button",{type:"button",onClick:F,class:"flex-1 rounded-md border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50",disabled:u.value}," Reset ",8,lt)])])]),l.value&&l.value.summary?(o(),r("div",rt,[e[15]||(e[15]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Report Summary",-1)),t("dl",dt,[(o(!0),r(i,null,x(l.value.summary,(s,v)=>(o(),r("div",{key:v,class:"bg-gray-50 rounded-lg p-4"},[t("dt",nt,a(v.replace(/_/g," ")),1),t("dd",it,a(s),1)]))),128))])])):y("",!0),l.value&&l.value.data&&l.value.data.length>0?(o(),r("div",ut,[t("div",pt,[t("h3",yt,[A(a(l.value.report_type.charAt(0).toUpperCase()+l.value.report_type.slice(1))+" Report ",1),t("span",ct," ("+a(l.value.data.length)+" records) ",1)])]),t("div",gt,[t("table",xt,[t("thead",mt,[t("tr",vt,[l.value.report_type==="attendance"?(o(),r(i,{key:0},[e[16]||(e[16]=t("th",{class:"px-6 py-3"},"Date",-1)),e[17]||(e[17]=t("th",{class:"px-6 py-3"},"Teacher",-1)),e[18]||(e[18]=t("th",{class:"px-6 py-3"},"Student",-1)),e[19]||(e[19]=t("th",{class:"px-6 py-3"},"Duration",-1)),e[20]||(e[20]=t("th",{class:"px-6 py-3"},"Minutes Attended",-1))],64)):l.value.report_type==="classes"?(o(),r(i,{key:1},[e[21]||(e[21]=t("th",{class:"px-6 py-3"},"Date & Time",-1)),e[22]||(e[22]=t("th",{class:"px-6 py-3"},"Teacher",-1)),e[23]||(e[23]=t("th",{class:"px-6 py-3"},"Student",-1)),e[24]||(e[24]=t("th",{class:"px-6 py-3"},"Type",-1)),e[25]||(e[25]=t("th",{class:"px-6 py-3"},"Book",-1))],64)):l.value.report_type==="payouts"?(o(),r(i,{key:2},[e[26]||(e[26]=t("th",{class:"px-6 py-3"},"Teacher",-1)),e[27]||(e[27]=t("th",{class:"px-6 py-3"},"Period",-1)),e[28]||(e[28]=t("th",{class:"px-6 py-3"},"Duration",-1)),e[29]||(e[29]=t("th",{class:"px-6 py-3"},"Total Classes",-1)),e[30]||(e[30]=t("th",{class:"px-6 py-3"},"Status",-1))],64)):l.value.report_type==="students"?(o(),r(i,{key:3},[e[31]||(e[31]=t("th",{class:"px-6 py-3"},"Name",-1)),e[32]||(e[32]=t("th",{class:"px-6 py-3"},"Nationality",-1)),e[33]||(e[33]=t("th",{class:"px-6 py-3"},"Total Classes",-1)),e[34]||(e[34]=t("th",{class:"px-6 py-3"},"Total Attendance",-1))],64)):y("",!0)])]),t("tbody",bt,[(o(!0),r(i,null,x(l.value.data,(s,v)=>(o(),r("tr",{key:v,class:"text-sm text-gray-700 hover:bg-gray-50"},[l.value.report_type==="attendance"?(o(),r(i,{key:0},[t("td",ft,a(m(s.date)),1),t("td",ht,a(s.teacher?.name??"—"),1),t("td",_t,a(s.student?.name??"—"),1),t("td",wt,a(s.duration??"—")+" min",1),t("td",kt,a(s.minutes_attended??"—")+" min",1)],64)):l.value.report_type==="classes"?(o(),r(i,{key:1},[t("td",Rt,a(m(s.start_date))+" "+a(s.start_time)+" - "+a(s.end_time),1),t("td",Tt,a(s.teacher?.name??"—"),1),t("td",Ct,a(s.student?.name??"—"),1),t("td",Dt,[t("span",{class:N(["px-2 py-1 text-xs font-medium rounded",s.type==="makeupClass"?"bg-red-100 text-red-800":s.type==="reoccurring"?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"])},a(s.type),3)]),t("td",St,a(s.book?.title??"—"),1)],64)):l.value.report_type==="payouts"?(o(),r(i,{key:2},[t("td",Vt,a(s.teacher?.name??"—"),1),t("td",At,a(m(s.start_date))+" - "+a(m(s.end_date)),1),t("td",Nt,a(s.duration??"—")+" hours",1),t("td",Ut,a(s.total_class??"—"),1),t("td",Bt,[t("span",{class:N(["px-2 py-1 text-xs font-medium rounded",s.status==="completed"?"bg-green-100 text-green-800":s.status==="processing"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},a(s.status),3)])],64)):l.value.report_type==="students"?(o(),r(i,{key:3},[t("td",Et,a(s.name),1),t("td",Gt,a(s.nationality??"—"),1),t("td",Ft,a(s.classes?.length??0),1),t("td",Mt,a(s.attendances?.length??0),1)],64)):y("",!0)]))),128))])])])])):!u.value&&!l.value?(o(),r("div",jt,[c(f(U),{class:"mx-auto h-12 w-12 text-gray-400"}),e[35]||(e[35]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No report generated",-1)),e[36]||(e[36]=t("p",{class:"mt-1 text-sm text-gray-500"},'Select filters and click "Generate Report" to view data.',-1))])):l.value&&l.value.data&&l.value.data.length===0?(o(),r("div",Pt,[c(f(U),{class:"mx-auto h-12 w-12 text-gray-400"}),e[37]||(e[37]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No data found",-1)),e[38]||(e[38]=t("p",{class:"mt-1 text-sm text-gray-500"},"Try adjusting your filters.",-1))])):y("",!0)])])]),_:1})],64))}};export{Lt as default};
