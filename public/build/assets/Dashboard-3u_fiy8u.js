import{u as E,r as y,j as c,o as K,c as r,a as s,b as d,h as L,w as O,d as e,g as n,F as u,q as _,e as p}from"./app-r5F7AQbe.js";import{e as m,a as C,i as R,d as x,b as V,r as q,j as w,c as k,m as z,_ as U}from"./AuthenticatedLayout-CNSH0xWk.js";import{_ as G,a as A,b as I}from"./ActivityTimeline-Cn4McFEo.js";import{_ as J}from"./DataTable-Bl9rcxwd.js";import{_ as B}from"./LineChart-CkHM3bDr.js";import{_ as $}from"./BarChart-D98mygzQ.js";import{_ as Q}from"./PieChart-BLpPP7lh.js";import{_ as X}from"./DonutChart-DrOR1XoO.js";import{a as Y}from"./api-COcabK3_.js";import{r as Z}from"./CheckCircleIcon-CNGI8Jtx.js";import{r as M}from"./ArrowTrendingUpIcon-CQhRoPeQ.js";import"./ArrowUpIcon-BRIgdKK5.js";const ee={class:"space-y-6 pb-8"},ae={key:0,class:"space-y-6"},te={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},oe={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},se={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},le={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},ne={class:"mb-4 flex items-center justify-between"},re={class:"h-64"},ie={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},ce={class:"mb-4 flex items-center justify-between"},de={class:"h-64"},ue={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},ge={class:"lg:col-span-2"},be={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},he={class:"h-64"},me={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3"},ve={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},ye={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},_e={class:"mb-4 flex items-center justify-between"},fe={class:"h-64"},pe={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},Ce={class:"mb-4 flex items-center justify-between"},xe={class:"h-64"},we={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},ke={class:"mb-4 flex items-center justify-between"},Ae={class:"h-80"},Ke={__name:"Dashboard",setup(Be){const T=E(),g=y(!1),l=y(null),v=y(!1),b=c(()=>T.props.auth?.user?.role??"teacher"),i=o=>{const a=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],t={primary:"rgba(59, 130, 246, 0.8)",secondary:"rgba(16, 185, 129, 0.8)"};if(o==="line")return{labels:a,datasets:[{label:"Classes",data:[12,19,15,25,22,18,14],borderColor:t.primary,backgroundColor:t.primary.replace("0.8","0.1"),fill:!0,tension:.4},{label:"Attendance",data:[8,15,12,20,18,14,10],borderColor:t.secondary,backgroundColor:t.secondary.replace("0.8","0.1"),fill:!0,tension:.4}]};if(o==="bar")return{labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"Hours",data:[20,25,22,28],backgroundColor:t.primary,borderRadius:8}]};if(o==="pie")return{labels:["Completed","Pending","Cancelled"],datasets:[{data:[65,25,10],backgroundColor:[t.secondary,"rgba(251, 191, 36, 0.8)","rgba(239, 68, 68, 0.8)"]}]};if(o==="donut")return{labels:["Active","Inactive"],datasets:[{data:[75,25],backgroundColor:[t.primary,"rgba(156, 163, 175, 0.8)"]}]}},S=c(()=>{if(!l.value||b.value!=="teacher")return[];const a=(l.value.stats??{}).dashboard??{},t=a.students??0,f=Array.isArray(a.activeClass)?a.activeClass.filter(h=>h!==null).length:a.activeClass&&a.activeClass!==null?1:0,H=Array.isArray(a.todayAttendance)?a.todayAttendance.filter(h=>h!==null).length:a.todayAttendance&&a.todayAttendance!==null?1:0,F=Array.isArray(a.pendingMakeups)?a.pendingMakeups.filter(h=>h!==null).length:a.pendingMakeups&&a.pendingMakeups!==null?1:0;return[{label:"Total Students",value:t,icon:m,iconBgColor:"bg-blue-50",iconColor:"text-blue-600",change:12},{label:"Active Classes",value:f,icon:C,iconBgColor:"bg-green-50",iconColor:"text-green-600",change:8},{label:"Today's Attendance",value:H,icon:R,iconBgColor:"bg-yellow-50",iconColor:"text-yellow-600",change:5},{label:"Pending Makeups",value:F,icon:x,iconBgColor:"bg-red-50",iconColor:"text-red-600",change:-3}]}),P=c(()=>{if(!l.value||b.value==="teacher")return[];const o=l.value.stats??{};return b.value==="super-admin"?[{label:"Total Admins",value:o.totalAdmins??0,icon:V,iconBgColor:"bg-indigo-50",iconColor:"text-indigo-600"},{label:"Teachers",value:o.totalTeachers??0,icon:m,iconBgColor:"bg-blue-50",iconColor:"text-blue-600",change:5},{label:"Students",value:o.totalStudents??0,icon:m,iconBgColor:"bg-green-50",iconColor:"text-green-600",change:12},{label:"Books",value:o.totalBooks??0,icon:q,iconBgColor:"bg-purple-50",iconColor:"text-purple-600"},{label:"Classes",value:o.totalClasses??0,icon:C,iconBgColor:"bg-pink-50",iconColor:"text-pink-600",change:8},{label:"Payouts",value:o.totalPayouts??0,icon:w,iconBgColor:"bg-yellow-50",iconColor:"text-yellow-600"}]:[{label:"Assigned Teachers",value:o.assignedTeachers??0,icon:m,iconBgColor:"bg-blue-50",iconColor:"text-blue-600"},{label:"Students",value:o.totalStudents??0,icon:m,iconBgColor:"bg-green-50",iconColor:"text-green-600",change:10},{label:"Hours This Month",value:o.totalHoursMonth??0,icon:x,iconBgColor:"bg-purple-50",iconColor:"text-purple-600",format:"number"},{label:"Estimated Payout",value:o.totalPaymentMonth??0,icon:w,iconBgColor:"bg-yellow-50",iconColor:"text-yellow-600",format:"currency"}]}),N=c(()=>l.value?((l.value.dashboard??{}).activeClass?.slice(0,5)??[]).map((t,f)=>({title:`Class with ${t.student||"Student"}`,description:t.book||"No book assigned",time:`${t.start_time||"N/A"} - ${t.end_time||"N/A"}`,icon:Z,iconBg:"bg-green-50",iconColor:"text-green-600"})):[]),j=c(()=>[{key:"student",label:"Student"},{key:"book",label:"Book"},{key:"start_time",label:"Time"},{key:"type",label:"Type"}]),D=c(()=>!l.value||b.value!=="teacher"?[]:((l.value.dashboard??{}).activeClass??[]).map(a=>({student:a.student||"N/A",book:a.book||"N/A",start_time:a.start_time||"N/A",type:a.type||"N/A"}))),W=async()=>{if(!(g.value||v.value)){g.value=!0;try{const{data:o}=await Y.get("/dashboard/stats");l.value=o,v.value=!0}catch(o){console.error("Dashboard stats error:",o),o.response?.status===401&&console.warn("Unauthorized - user may need to re-login")}finally{g.value=!1}}};return K(()=>{!v.value&&!g.value&&W()}),(o,a)=>(n(),r(u,null,[s(d(L),{title:"Dashboard"}),s(U,null,{default:O(()=>[e("div",ee,[s(G),g.value?(n(),r("div",ae,[e("div",te,[(n(),r(u,null,_(4,t=>e("div",{key:t,class:"h-32 rounded-xl bg-gray-200 animate-pulse"})),64))]),a[0]||(a[0]=e("div",{class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},[e("div",{class:"h-96 rounded-xl bg-gray-200 animate-pulse"}),e("div",{class:"h-96 rounded-xl bg-gray-200 animate-pulse"})],-1))])):b.value==="teacher"?(n(),r(u,{key:1},[e("div",oe,[(n(!0),r(u,null,_(S.value,t=>(n(),p(A,{key:t.label,label:t.label,value:t.value,icon:t.icon,"icon-bg-color":t.iconBgColor,"icon-color":t.iconColor,change:t.change,trend:!0},null,8,["label","value","icon","icon-bg-color","icon-color","change"]))),128))]),e("div",se,[e("div",le,[e("div",ne,[a[1]||(a[1]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Weekly Performance ",-1)),s(d(k),{class:"h-5 w-5 text-gray-400"})]),e("div",re,[s(B,{data:i("line")},null,8,["data"])])]),e("div",ie,[e("div",ce,[a[2]||(a[2]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Monthly Hours ",-1)),s(d(M),{class:"h-5 w-5 text-gray-400"})]),e("div",de,[s($,{data:i("bar")},null,8,["data"])])])]),e("div",ue,[e("div",ge,[s(I,{activities:N.value},null,8,["activities"])]),e("div",be,[a[3]||(a[3]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-900"}," Class Status "),e("p",{class:"mt-1 text-sm text-gray-500"}," Overview of class distribution ")],-1)),e("div",he,[s(X,{data:i("donut")},null,8,["data"])])])]),s(J,{title:"Recent Classes",columns:j.value,data:D.value,searchable:!0,paginated:!0,"items-per-page":5},null,8,["columns","data"])],64)):(n(),r(u,{key:2},[e("div",me,[(n(!0),r(u,null,_(P.value,t=>(n(),p(A,{key:t.label,label:t.label,value:t.value,icon:t.icon,"icon-bg-color":t.iconBgColor,"icon-color":t.iconColor,change:t.change,format:t.format||"number",trend:!0},null,8,["label","value","icon","icon-bg-color","icon-color","change","format"]))),128))]),e("div",ve,[e("div",ye,[e("div",_e,[a[4]||(a[4]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Activity Trends ",-1)),s(d(k),{class:"h-5 w-5 text-gray-400"})]),e("div",fe,[s(B,{data:i("line")},null,8,["data"])])]),e("div",pe,[e("div",Ce,[a[5]||(a[5]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Distribution ",-1)),s(d(z),{class:"h-5 w-5 text-gray-400"})]),e("div",xe,[s(Q,{data:i("pie")},null,8,["data"])])])]),e("div",we,[e("div",ke,[a[6]||(a[6]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Monthly Overview ",-1)),s(d(M),{class:"h-5 w-5 text-gray-400"})]),e("div",Ae,[s($,{data:i("bar")},null,8,["data"])])])],64))])]),_:1})],64))}};export{Ke as default};
