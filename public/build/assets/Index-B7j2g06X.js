import{c as i,d as e,g as l,u as F,r as h,j as S,o as T,a as r,b as c,h as L,w as o,e as y,k as p,f as _,t as n,y as k,z as Z,F as I}from"./app-r5F7AQbe.js";import{m as $,l as z,_ as H}from"./AuthenticatedLayout-CNSH0xWk.js";import{_ as P}from"./AdvancedTable-DeA0jASj.js";import{_ as w}from"./Card-2P4Rmxrj.js";import{_ as b}from"./Badge-l3XqjddH.js";import{_ as U}from"./Button-BteD-aKC.js";import{a as g}from"./api-COcabK3_.js";import{r as C}from"./CheckCircleIcon-CNGI8Jtx.js";import{r as q}from"./TrashIcon-Q9E64JkZ.js";import{r as J}from"./XCircleIcon-C1DMX2PD.js";import"./ArrowDownTrayIcon-DZwgirt0.js";import"./ArrowUpIcon-BRIgdKK5.js";function N(v,d){return l(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 12.75 6 6 9-13.5"})])}function O(v,d){return l(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function W(v,d){return l(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})])}const G={class:"space-y-6 pb-8"},K={class:"flex items-center justify-between"},Q={class:"grid grid-cols-1 gap-6 sm:grid-cols-3"},X={class:"flex items-center justify-between"},Y={class:"mt-2 text-3xl font-semibold text-gray-900"},ee={class:"rounded-lg bg-blue-50 p-3"},te={class:"flex items-center justify-between"},ae={class:"mt-2 text-3xl font-semibold text-gray-900"},se={class:"rounded-lg bg-yellow-50 p-3"},re={class:"flex items-center justify-between"},oe={class:"mt-2 text-3xl font-semibold text-gray-900"},le={class:"rounded-lg bg-green-50 p-3"},ne={class:"flex items-start gap-3"},ie={class:"flex-1 min-w-0"},ce={class:"flex items-center gap-2"},de={class:"font-medium text-gray-900"},ue={key:0,class:"mt-1 text-sm text-gray-500 line-clamp-2"},fe={key:1,class:"mt-1 text-xs text-gray-400"},me={class:"flex items-center justify-end gap-2"},pe=["onClick"],ge=["onClick"],ye={key:1,class:"space-y-4"},Re={__name:"Index",setup(v){F();const d=h(!1),u=h([]);h(null);const j=[{key:"notification",label:"Notification",sortable:!1},{key:"type",label:"Type",sortable:!0,align:"center"},{key:"created_at",label:"Date",sortable:!0,format:"datetime"},{key:"status",label:"Status",sortable:!0,align:"center"}],A=[{key:"type",label:"Type",type:"select",options:[{value:"",label:"All Types"},{value:"info",label:"Info"},{value:"warning",label:"Warning"},{value:"success",label:"Success"},{value:"error",label:"Error"}]},{key:"is_read",label:"Status",type:"select",options:[{value:"",label:"All"},{value:"false",label:"Unread"},{value:"true",label:"Read"}]}],f=async()=>{d.value=!0;try{const{data:a}=await g.get("/notification");u.value=Array.isArray(a.notifications||a)?(a.notifications||a).map(t=>({...t,status:t.is_read?"read":"unread"})):[]}catch(a){console.error("Error fetching notifications:",a),u.value=[]}finally{d.value=!1}},R=async a=>{if(!a.is_read)try{await g.patch(`/notification/${a.id}`,{is_read:!0}),a.is_read=!0,a.status="read",await f()}catch(t){console.error("Error marking notification as read:",t)}},B=async()=>{try{await g.post("/notification/mark-all-read"),await f()}catch(a){console.error("Error marking all as read:",a),alert("Failed to mark all as read")}},M=async a=>{if(confirm("Delete this notification?"))try{await g.delete(`/notification/${a.id}`),await f()}catch(t){console.error("Error deleting notification:",t),alert("Failed to delete notification")}},D=async()=>{if(confirm(`Are you sure you want to delete ${selectedRows.value.length} notification(s)?`))try{await Promise.all(selectedRows.value.map(a=>g.delete(`/notification/${a.id}`))),selectedRows.value=[],await f()}catch(a){console.error("Error bulk deleting notifications:",a),alert("Failed to delete some notifications")}},E=a=>{const t={info:W,warning:O,success:C,error:J,default:$};return t[a?.toLowerCase()]||t.default},m=a=>{const t={info:"blue",warning:"yellow",success:"green",error:"red",default:"blue"};return t[a?.toLowerCase()]||t.default},x=S(()=>u.value.filter(a=>!a.is_read).length);return T(()=>{f()}),(a,t)=>(l(),i(I,null,[r(c(L),{title:"Notifications"}),r(H,null,{default:o(()=>[e("div",G,[e("div",K,[t[1]||(t[1]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Notifications"),e("p",{class:"mt-1 text-sm text-gray-500"}," Manage your notifications ")],-1)),x.value>0?(l(),y(U,{key:0,onClick:B,variant:"secondary"},{default:o(()=>[r(c(N),{class:"h-4 w-4 mr-2"}),t[0]||(t[0]=_(" Mark All as Read ",-1))]),_:1})):p("",!0)]),e("div",Q,[r(w,{class:"p-6"},{default:o(()=>[e("div",X,[e("div",null,[t[2]||(t[2]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Notifications",-1)),e("p",Y,n(u.value.length),1)]),e("div",ee,[r(c($),{class:"h-8 w-8 text-blue-600"})])])]),_:1}),r(w,{class:"p-6"},{default:o(()=>[e("div",te,[e("div",null,[t[3]||(t[3]=e("p",{class:"text-sm font-medium text-gray-600"},"Unread",-1)),e("p",ae,n(x.value),1),t[4]||(t[4]=e("p",{class:"mt-1 text-xs text-yellow-600"},"Requires attention",-1))]),e("div",se,[r(c(z),{class:"h-8 w-8 text-yellow-600"})])])]),_:1}),r(w,{class:"p-6"},{default:o(()=>[e("div",re,[e("div",null,[t[5]||(t[5]=e("p",{class:"text-sm font-medium text-gray-600"},"Read",-1)),e("p",oe,n(u.value.length-x.value),1),t[6]||(t[6]=e("p",{class:"mt-1 text-xs text-gray-500"},"Viewed",-1))]),e("div",le,[r(c(C),{class:"h-8 w-8 text-green-600"})])])]),_:1})]),d.value?(l(),i("div",ye,[...t[8]||(t[8]=[e("div",{class:"h-64 rounded-xl bg-gray-200 animate-pulse"},null,-1)])])):(l(),y(P,{key:0,title:"All Notifications",columns:j,data:u.value,searchable:!0,paginated:!0,selectable:!0,filters:A,"items-per-page":25,"row-key":"id",onBulkDelete:D},{"cell-notification":o(({row:s})=>[e("div",ne,[e("div",{class:k(["flex h-10 w-10 items-center justify-center rounded-lg",`bg-${m(s.type)}-50`])},[(l(),y(Z(E(s.type)),{class:k(["h-5 w-5",`text-${m(s.type)}-600`])},null,8,["class"]))],2),e("div",ie,[e("div",ce,[e("p",de,n(s.label||s.type||"Notification"),1),s.is_read?p("",!0):(l(),y(b,{key:0,variant:"warning",class:"text-xs"},{default:o(()=>[...t[7]||(t[7]=[_("New",-1)])]),_:1}))]),s.message?(l(),i("p",ue,n(s.message),1)):p("",!0),s.data?(l(),i("p",fe,n(JSON.stringify(s.data)),1)):p("",!0)])])]),"cell-type":o(({row:s})=>[r(b,{variant:m(s.type)==="red"?"danger":m(s.type)==="yellow"?"warning":m(s.type)==="green"?"success":"primary"},{default:o(()=>[_(n(s.type||"info"),1)]),_:2},1032,["variant"])]),"cell-status":o(({row:s})=>[r(b,{variant:s.is_read?"secondary":"warning"},{default:o(()=>[_(n(s.status||(s.is_read?"read":"unread")),1)]),_:2},1032,["variant"])]),"row-actions":o(({row:s})=>[e("div",me,[s.is_read?p("",!0):(l(),i("button",{key:0,onClick:V=>R(s),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-blue-600 transition-colors",title:"Mark as Read"},[r(c(N),{class:"h-5 w-5"})],8,pe)),e("button",{onClick:V=>M(s),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-red-600 transition-colors",title:"Delete"},[r(c(q),{class:"h-5 w-5"})],8,ge)])]),_:1},8,["data"]))])]),_:1})],64))}};export{Re as default};
