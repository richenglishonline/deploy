import{l as k,r as m,m as i,o as $,c as d,b as o,u,h as B,w as A,d as e,f as r,F as g,g as v,p as N}from"./app-BCSl8rWO.js";import{g as S,b as _,r as T,d as D,c as P,e as W,f as j,_ as F}from"./AuthenticatedLayout-BF1ft56-.js";import{r as M,_ as O,a as L,b as R,c as V,d as z,e as E,f as H,g as K}from"./DonutChart-DYB6JVZF.js";import{_ as U}from"./PieChart-2BSghhte.js";import{a as q}from"./api-DUuehXth.js";const G={class:"space-y-6 pb-8"},J={key:0,class:"space-y-6"},Q={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},X={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3"},Y={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},Z={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},I={class:"mb-4 flex items-center justify-between"},ee={class:"h-64"},ae={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},se={class:"mb-4 flex items-center justify-between"},te={class:"h-64"},oe={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},le={class:"mb-4 flex items-center justify-between"},re={class:"h-80"},ne={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},ie={class:"lg:col-span-2"},de={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},ce={class:"h-64"},fe={__name:"Dashboard",setup(ue){const h=k(),n=m(!1),l=m(null),b=m(!1),f=i(()=>h.props.auth?.user?.role??"super-admin"),c=s=>{const t=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],a={primary:"rgba(59, 130, 246, 0.8)",secondary:"rgba(16, 185, 129, 0.8)"};if(s==="line")return{labels:t,datasets:[{label:"Classes",data:[12,19,15,25,22,18,14],borderColor:a.primary,backgroundColor:a.primary.replace("0.8","0.1"),fill:!0,tension:.4},{label:"Attendance",data:[8,15,12,20,18,14,10],borderColor:a.secondary,backgroundColor:a.secondary.replace("0.8","0.1"),fill:!0,tension:.4}]};if(s==="bar")return{labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"Hours",data:[20,25,22,28],backgroundColor:a.primary,borderRadius:8}]};if(s==="pie")return{labels:["Completed","Pending","Cancelled"],datasets:[{data:[65,25,10],backgroundColor:[a.secondary,"rgba(251, 191, 36, 0.8)","rgba(239, 68, 68, 0.8)"]}]};if(s==="donut")return{labels:["Active","Inactive"],datasets:[{data:[75,25],backgroundColor:[a.primary,"rgba(156, 163, 175, 0.8)"]}]}},p=i(()=>{if(!l.value||f.value!=="super-admin")return[];const s=l.value.stats??{};return[{label:"Total Admins",value:s.totalAdmins??0,icon:S,iconBgColor:"bg-indigo-50",iconColor:"text-indigo-600"},{label:"Teachers",value:s.totalTeachers??0,icon:_,iconBgColor:"bg-blue-50",iconColor:"text-blue-600",change:5},{label:"Students",value:s.totalStudents??0,icon:_,iconBgColor:"bg-green-50",iconColor:"text-green-600",change:12},{label:"Books",value:s.totalBooks??0,icon:T,iconBgColor:"bg-purple-50",iconColor:"text-purple-600"},{label:"Classes",value:s.totalClasses??0,icon:D,iconBgColor:"bg-pink-50",iconColor:"text-pink-600",change:8},{label:"Payouts",value:s.totalPayouts??0,icon:P,iconBgColor:"bg-yellow-50",iconColor:"text-yellow-600"}]}),y=i(()=>l.value?((l.value.dashboard??{}).activeClass?.slice(0,5)??[]).map((a,ge)=>({title:`Class with ${a.student||"Student"}`,description:a.book||"No book assigned",time:`${a.start_time||"N/A"} - ${a.end_time||"N/A"}`,icon:M,iconBg:"bg-green-50",iconColor:"text-green-600"})):[]),C=i(()=>[{key:"student",label:"Student"},{key:"book",label:"Book"},{key:"start_time",label:"Time"},{key:"type",label:"Type"}]),x=i(()=>l.value?((l.value.dashboard??{}).activeClass??[]).map(t=>({student:t.student||"N/A",book:t.book||"N/A",start_time:t.start_time||"N/A",type:t.type||"N/A"})):[]),w=async()=>{if(!(n.value||b.value)){n.value=!0;try{const{data:s}=await q.get("/dashboard/stats");l.value=s,b.value=!0}catch(s){console.error("Dashboard stats error:",s),s.response?.status===401&&console.warn("Unauthorized - user may need to re-login")}finally{n.value=!1}}};return $(()=>{!b.value&&!n.value&&w()}),(s,t)=>(r(),d(g,null,[o(u(B),{title:"Dashboard"}),o(F,null,{default:A(()=>[e("div",G,[o(O),n.value?(r(),d("div",J,[e("div",Q,[(r(),d(g,null,v(4,a=>e("div",{key:a,class:"h-32 rounded-xl bg-gray-200 animate-pulse"})),64))]),t[0]||(t[0]=e("div",{class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},[e("div",{class:"h-96 rounded-xl bg-gray-200 animate-pulse"}),e("div",{class:"h-96 rounded-xl bg-gray-200 animate-pulse"})],-1))])):(r(),d(g,{key:1},[e("div",X,[(r(!0),d(g,null,v(p.value,a=>(r(),N(L,{key:a.label,label:a.label,value:a.value,icon:a.icon,"icon-bg-color":a.iconBgColor,"icon-color":a.iconColor,change:a.change,format:a.format||"number",trend:!0},null,8,["label","value","icon","icon-bg-color","icon-color","change","format"]))),128))]),e("div",Y,[e("div",Z,[e("div",I,[t[1]||(t[1]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Activity Trends ",-1)),o(u(W),{class:"h-5 w-5 text-gray-400"})]),e("div",ee,[o(R,{data:c("line")},null,8,["data"])])]),e("div",ae,[e("div",se,[t[2]||(t[2]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Distribution ",-1)),o(u(j),{class:"h-5 w-5 text-gray-400"})]),e("div",te,[o(U,{data:c("pie")},null,8,["data"])])])]),e("div",oe,[e("div",le,[t[3]||(t[3]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Monthly Overview ",-1)),o(u(V),{class:"h-5 w-5 text-gray-400"})]),e("div",re,[o(z,{data:c("bar")},null,8,["data"])])]),e("div",ne,[e("div",ie,[o(E,{activities:y.value},null,8,["activities"])]),e("div",de,[t[4]||(t[4]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-900"}," Status Overview "),e("p",{class:"mt-1 text-sm text-gray-500"}," Overview of system distribution ")],-1)),e("div",ce,[o(H,{data:c("donut")},null,8,["data"])])])]),o(K,{title:"Recent Classes",columns:C.value,data:x.value,searchable:!0,paginated:!0,"items-per-page":5},null,8,["columns","data"])],64))])]),_:1})],64))}};export{fe as default};
