import{l as R,m as z,r as k,a as M,o as H,c as y,b as s,u as V,h as q,w as i,d as t,k as c,q as C,f as p,F as h,g as N,t as r,v as U,e as E,i as B,n as d,j as G,p as J}from"./app-0fzbWLMr.js";import{_ as Q}from"./AuthenticatedLayout-7O23QDDk.js";import{a as S}from"./api-CjtnGutK.js";import{_ as x}from"./Button-lzdat9VZ.js";import{_ as W,a as X,b as Y,c as ee}from"./DialogFooter-qDcU_0lk.js";import{_ as te}from"./DialogDescription-BQFp_t3y.js";import{_ as g,a as v}from"./Label-DdYipys5.js";import{r as le}from"./PencilIcon-DIAPLmMj.js";import{r as oe}from"./TrashIcon-BrIAeb1F.js";const se={class:"flex items-center justify-between"},ae={class:"flex items-center gap-3"},ie=["disabled"],ne={class:"py-10"},de={class:"mx-auto max-w-7xl space-y-6 px-4 sm:px-6 lg:px-8"},re={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm"},ue={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},pe=["value"],me=["value"],fe={class:"flex items-end gap-3"},ye=["disabled"],ge=["disabled"],ve={class:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm"},ce={class:"overflow-x-auto"},be={class:"min-w-full divide-y divide-gray-200"},xe={class:"divide-y divide-gray-200 bg-white"},_e={key:0},ke={class:"px-6 py-4"},we={class:"font-medium text-gray-900"},Ve={class:"text-gray-500"},Ce={class:"px-6 py-4"},he={class:"px-6 py-4"},Ue={class:"px-6 py-4"},Se={class:"px-6 py-4"},Ae={class:"px-6 py-4"},$e={class:"px-6 py-4"},Ne={key:0,class:"px-6 py-4"},Ee={class:"flex items-center gap-2"},Pe={key:1,class:"px-6 py-4"},De={key:0,class:"flex flex-col items-center justify-between gap-4 border-t border-gray-100 px-6 py-4 text-sm text-gray-600 sm:flex-row"},Me={class:"flex items-center gap-2"},Be=["disabled"],Te=["disabled"],Ze={class:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto"},Le={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Oe={class:"space-y-2"},je={class:"space-y-2"},Fe={class:"space-y-2"},Ie={class:"space-y-2"},Ke={class:"space-y-2"},Re={class:"space-y-2"},ze={class:"space-y-2"},He={class:"space-y-2"},qe={class:"space-y-2 sm:col-span-2"},Ge={class:"space-y-2 sm:col-span-2"},Je={class:"space-y-2 sm:col-span-2"},Qe={key:0,class:"text-xs text-muted-foreground"},We={key:1,class:"text-xs text-muted-foreground"},dt={__name:"Index",setup(Xe){const T=R(),P=z(()=>T.props.auth?.user?.role==="super-admin"),m=k(!1),A=k([]),f=k(null),n=M({name:"",nationality:"",manager_type:"",category_level:"",class_type:"",platform:"",page:1,limit:10}),Z=["KOREAN","CHINESE"],L=["Zoom","Voov"],b=async()=>{m.value=!0;try{const{data:o}=await S.get("/students",{params:n});A.value=o.students,f.value=o.pagination??{total:o.total??o.students.length,page:1,totalPages:1}}catch(o){console.error(o)}finally{m.value=!1}},D=o=>{f.value&&(o<1||o>f.value.totalPages||(n.page=o,b()))},O=()=>{n.name="",n.nationality="",n.manager_type="",n.category_level="",n.class_type="",n.platform="",n.page=1,b()},_=k(!1),u=k(null),w=k(!1),a=M({name:"",age:"",nationality:"",manager_type:"",email:"",category_level:"",class_type:"",platform:"Zoom",platform_link:"",preferred_book:"",student_identification:""}),j=()=>{u.value=null,Object.assign(a,{name:"",age:"",nationality:"",manager_type:"",email:"",category_level:"",class_type:"",platform:"Zoom",platform_link:"",preferred_book:"",student_identification:""}),_.value=!0},F=o=>{u.value=o,Object.assign(a,{name:o.name||"",age:o.age||"",nationality:o.nationality||"",manager_type:o.manager_type||"",email:o.email||"",category_level:o.category_level||"",class_type:o.class_type||"",platform:o.platform||"Zoom",platform_link:o.platform_link||"",preferred_book:o.preferred_book||"",student_identification:o.student_identification||""}),_.value=!0},I=async()=>{w.value=!0;try{const o={...a};u.value?delete o.student_identification:o.student_identification||delete o.student_identification,u.value?await S.patch(`/students/${u.value.id}`,o):await S.post("/students",o),_.value=!1,await b()}catch(o){console.error("Error saving student:",o),alert(o.response?.data?.message||"Failed to save student")}finally{w.value=!1}},K=async o=>{if(confirm(`Delete ${o.name}?`))try{m.value=!0,await S.delete(`/students/${o.id}`),await b()}catch(e){console.error("Error deleting student:",e)}finally{m.value=!1}};return H(b),(o,e)=>(p(),y(h,null,[s(V(q),{title:"Students"}),s(Q,null,{header:i(()=>[t("div",se,[e[22]||(e[22]=t("div",null,[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Students "),t("p",{class:"text-sm text-gray-500"}," Manage enrolled learners, filter by profile, and update information. ")],-1)),t("div",ae,[P.value?(p(),J(x,{key:0,onClick:j,disabled:m.value},{default:i(()=>[...e[21]||(e[21]=[d(" Add Student ",-1)])]),_:1},8,["disabled"])):E("",!0),t("button",{onClick:b,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:m.value}," Refresh ",8,ie)])])]),default:i(()=>[t("div",ne,[t("div",de,[t("div",re,[t("form",ue,[t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700"}," Name ",-1)),c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>n.name=l),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Search name"},null,512),[[C,n.name]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700"}," Nationality ",-1)),c(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>n.nationality=l),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[e[24]||(e[24]=t("option",{value:""},"Any",-1)),(p(),y(h,null,N(Z,l=>t("option",{key:l,value:l},r(l),9,pe)),64))],512),[[U,n.nationality]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700"}," Manager Type ",-1)),c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>n.manager_type=l),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"KM / CM"},null,512),[[C,n.manager_type]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700"}," Category Level ",-1)),c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>n.category_level=l),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Beginner, Adult..."},null,512),[[C,n.category_level]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700"}," Class Type ",-1)),c(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>n.class_type=l),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Zoom, Voov..."},null,512),[[C,n.class_type]])]),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700"}," Platform ",-1)),c(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>n.platform=l),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[e[29]||(e[29]=t("option",{value:""},"Any",-1)),(p(),y(h,null,N(L,l=>t("option",{key:l,value:l},r(l),9,me)),64))],512),[[U,n.platform]])]),t("div",fe,[t("button",{type:"button",onClick:b,class:"flex-1 rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:m.value}," Apply Filters ",8,ye),t("button",{type:"button",onClick:O,class:"flex-1 rounded-md border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50",disabled:m.value}," Reset ",8,ge)])])]),t("div",ve,[t("div",ce,[t("table",be,[e[36]||(e[36]=t("thead",{class:"bg-gray-50"},[t("tr",{class:"text-left text-xs font-semibold uppercase tracking-wider text-gray-500"},[t("th",{scope:"col",class:"px-6 py-3"}," Student "),t("th",{scope:"col",class:"px-6 py-3"}," Nationality "),t("th",{scope:"col",class:"px-6 py-3"}," Category Level "),t("th",{scope:"col",class:"px-6 py-3"}," Class Type "),t("th",{scope:"col",class:"px-6 py-3"}," Platform "),t("th",{scope:"col",class:"px-6 py-3"}," Preferred Book "),t("th",{scope:"col",class:"px-6 py-3"}," Updated "),t("th",{scope:"col",class:"px-6 py-3"}," Actions ")])],-1)),t("tbody",xe,[!m.value&&A.value.length===0?(p(),y("tr",_e,[...e[31]||(e[31]=[t("td",{colspan:"8",class:"px-6 py-4 text-center text-sm text-gray-500"}," No students found. ",-1)])])):E("",!0),(p(!0),y(h,null,N(A.value,l=>(p(),y("tr",{key:l.id,class:"text-sm text-gray-700"},[t("td",ke,[t("div",we,r(l.name),1),t("div",Ve,r(l.email??"—"),1)]),t("td",Ce,r(l.nationality??"—"),1),t("td",he,r(l.category_level??"—"),1),t("td",Ue,r(l.class_type??"—"),1),t("td",Se,r(l.platform??"—"),1),t("td",Ae,r(l.preferred_book??"—"),1),t("td",$e,r(l.updated_at?new Date(l.updated_at).toLocaleDateString():"—"),1),P.value?(p(),y("td",Ne,[t("div",Ee,[s(x,{onClick:$=>V(B).visit(o.route("students.show",l.id)),variant:"outline",size:"sm"},{default:i(()=>[...e[32]||(e[32]=[d(" View ",-1)])]),_:1},8,["onClick"]),s(x,{onClick:$=>F(l),variant:"outline",size:"sm"},{default:i(()=>[s(V(le),{class:"h-4 w-4"}),e[33]||(e[33]=d(" Edit ",-1))]),_:1},8,["onClick"]),s(x,{onClick:$=>K(l),variant:"destructive",size:"sm"},{default:i(()=>[s(V(oe),{class:"h-4 w-4"}),e[34]||(e[34]=d(" Delete ",-1))]),_:1},8,["onClick"])])])):(p(),y("td",Pe,[s(x,{onClick:$=>V(B).visit(o.route("students.show",l.id)),variant:"outline",size:"sm"},{default:i(()=>[...e[35]||(e[35]=[d(" View ",-1)])]),_:1},8,["onClick"])]))]))),128))])])]),f.value?(p(),y("div",De,[t("div",null," Page "+r(f.value.page)+" of "+r(f.value.totalPages??1),1),t("div",Me,[t("button",{onClick:e[6]||(e[6]=l=>D(f.value.page-1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:m.value||f.value.page===1}," Previous ",8,Be),t("button",{onClick:e[7]||(e[7]=l=>D(f.value.page+1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:m.value||f.value.page===f.value.totalPages}," Next ",8,Te)])])):E("",!0)])])]),s(W,{open:_.value,"onUpdate:open":e[20]||(e[20]=l=>_.value=l)},{default:i(()=>[t("div",Ze,[s(X,null,{default:i(()=>[s(Y,null,{default:i(()=>[d(r(u.value?"Update Student":"Add Student"),1)]),_:1}),s(te,null,{default:i(()=>[d(r(u.value?"Update student information":"Add a new student to the system"),1)]),_:1})]),_:1}),t("form",{onSubmit:G(I,["prevent"]),class:"space-y-4"},[t("div",Le,[t("div",Oe,[s(g,null,{default:i(()=>[...e[37]||(e[37]=[d(" Name ",-1),t("span",{class:"text-destructive"},"*",-1)])]),_:1}),s(v,{modelValue:a.name,"onUpdate:modelValue":e[8]||(e[8]=l=>a.name=l),type:"text",required:"",placeholder:"Student name"},null,8,["modelValue"])]),t("div",je,[s(g,null,{default:i(()=>[...e[38]||(e[38]=[d("Age",-1)])]),_:1}),s(v,{modelValue:a.age,"onUpdate:modelValue":e[9]||(e[9]=l=>a.age=l),type:"number",placeholder:"Age"},null,8,["modelValue"])]),t("div",Fe,[s(g,null,{default:i(()=>[...e[39]||(e[39]=[d("Email",-1)])]),_:1}),s(v,{modelValue:a.email,"onUpdate:modelValue":e[10]||(e[10]=l=>a.email=l),type:"email",placeholder:"student@example.com"},null,8,["modelValue"])]),t("div",Ie,[s(g,null,{default:i(()=>[...e[40]||(e[40]=[d("Nationality",-1)])]),_:1}),c(t("select",{"onUpdate:modelValue":e[11]||(e[11]=l=>a.nationality=l),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"},[...e[41]||(e[41]=[t("option",{value:""},"Select nationality",-1),t("option",{value:"KOREAN"},"KOREAN",-1),t("option",{value:"CHINESE"},"CHINESE",-1)])],512),[[U,a.nationality]])]),t("div",Ke,[s(g,null,{default:i(()=>[...e[42]||(e[42]=[d("Manager Type",-1)])]),_:1}),s(v,{modelValue:a.manager_type,"onUpdate:modelValue":e[12]||(e[12]=l=>a.manager_type=l),type:"text",placeholder:"KM / CM"},null,8,["modelValue"])]),t("div",Re,[s(g,null,{default:i(()=>[...e[43]||(e[43]=[d("Category Level",-1)])]),_:1}),s(v,{modelValue:a.category_level,"onUpdate:modelValue":e[13]||(e[13]=l=>a.category_level=l),type:"text",placeholder:"Beginner, Adult..."},null,8,["modelValue"])]),t("div",ze,[s(g,null,{default:i(()=>[...e[44]||(e[44]=[d("Class Type",-1)])]),_:1}),s(v,{modelValue:a.class_type,"onUpdate:modelValue":e[14]||(e[14]=l=>a.class_type=l),type:"text",placeholder:"Class type"},null,8,["modelValue"])]),t("div",He,[s(g,null,{default:i(()=>[...e[45]||(e[45]=[d("Platform",-1)])]),_:1}),c(t("select",{"onUpdate:modelValue":e[15]||(e[15]=l=>a.platform=l),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"},[...e[46]||(e[46]=[t("option",{value:"Zoom"},"Zoom",-1),t("option",{value:"Voov"},"Voov",-1)])],512),[[U,a.platform]])]),t("div",qe,[s(g,null,{default:i(()=>[...e[47]||(e[47]=[d("Platform Link",-1)])]),_:1}),s(v,{modelValue:a.platform_link,"onUpdate:modelValue":e[16]||(e[16]=l=>a.platform_link=l),type:"url",placeholder:"https://..."},null,8,["modelValue"])]),t("div",Ge,[s(g,null,{default:i(()=>[...e[48]||(e[48]=[d("Preferred Book",-1)])]),_:1}),s(v,{modelValue:a.preferred_book,"onUpdate:modelValue":e[17]||(e[17]=l=>a.preferred_book=l),type:"text",placeholder:"Preferred book"},null,8,["modelValue"])]),t("div",Je,[s(g,null,{default:i(()=>[e[49]||(e[49]=d(" Student ID ",-1)),u.value?(p(),y("span",We," (Cannot be changed) ")):(p(),y("span",Qe," (Auto-generated if empty) "))]),_:1}),s(v,{modelValue:a.student_identification,"onUpdate:modelValue":e[18]||(e[18]=l=>a.student_identification=l),type:"text",disabled:!!u.value,placeholder:u.value?"":"Auto-generated if empty"},null,8,["modelValue","disabled","placeholder"])])]),s(ee,null,{default:i(()=>[s(x,{type:"button",variant:"outline",onClick:e[19]||(e[19]=l=>_.value=!1),disabled:w.value},{default:i(()=>[...e[50]||(e[50]=[d(" Cancel ",-1)])]),_:1},8,["disabled"]),s(x,{type:"submit",disabled:w.value},{default:i(()=>[d(r(w.value?u.value?"Updating...":"Adding...":u.value?"Update":"Add"),1)]),_:1},8,["disabled"])]),_:1})],32)])]),_:1},8,["open"])]),_:1})],64))}};export{dt as default};
