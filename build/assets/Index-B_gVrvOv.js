import{u as L,r as d,o as O,c as _,a as l,b as n,h as U,w as r,d as t,e as M,i as $,f as h,t as o,g as c,k as F,F as I}from"./app-Cmmq__Tw.js";import{a as C,d as P,e as q,b as z,_ as G}from"./AuthenticatedLayout-B2GbnFPi.js";import{_ as H}from"./AdvancedTable-CIaIA73U.js";import{_ as J}from"./Button-D72KtQR-.js";import{_ as A}from"./Badge-BZFBi4LI.js";import{_ as u}from"./Card-CcoMGp7w.js";import{a as m}from"./api-BS-ONIJM.js";import{r as K}from"./PlusIcon-3lCZdoOe.js";import{r as Q}from"./CheckCircleIcon-Cn5KpQJI.js";import{r as W}from"./XCircleIcon-bxbXGNCl.js";import{r as X}from"./EyeIcon-DroDtrWB.js";import"./ArrowDownTrayIcon-CzbVfJHZ.js";import"./ArrowUpIcon-DRFX-h9Y.js";import"./TrashIcon-DD0p8Ace.js";const Y={class:"space-y-6 pb-8"},Z={class:"flex items-center justify-between"},ee={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},te={class:"flex items-center justify-between"},se={class:"mt-2 text-3xl font-semibold text-gray-900"},ae={class:"rounded-lg bg-blue-50 p-3"},le={class:"flex items-center justify-between"},re={class:"mt-2 text-3xl font-semibold text-gray-900"},oe={class:"rounded-lg bg-yellow-50 p-3"},ne={class:"flex items-center justify-between"},ie={class:"mt-2 text-3xl font-semibold text-gray-900"},de={class:"rounded-lg bg-green-50 p-3"},ce={class:"flex items-center justify-between"},ue={class:"mt-2 text-3xl font-semibold text-gray-900"},me={class:"rounded-lg bg-red-50 p-3"},pe={class:"flex items-center gap-3"},ge={class:"flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-indigo-600"},fe={class:"font-medium text-gray-900"},ye={key:0,class:"text-xs text-gray-500"},_e={class:"flex items-center gap-2"},he={class:"text-gray-900"},xe={class:"flex items-center gap-2"},ve={class:"text-gray-900"},be={class:"text-gray-900"},ke={class:"text-gray-900"},we=["onClick"],$e={key:1,class:"space-y-4"},Fe={__name:"Index",setup(Ce){L();const p=d(!1),i=d([]),x=d(null),v=d([]),b=d([]),g=[{key:"class_info",label:"Class",sortable:!1},{key:"teacher",label:"Teacher",sortable:!0},{key:"student",label:"Student",sortable:!0},{key:"book",label:"Book",sortable:!0},{key:"schedule",label:"Schedule",sortable:!0},{key:"type",label:"Type",sortable:!0,align:"center"},{key:"status",label:"Status",sortable:!0,align:"center"}],S=[{key:"teacher_id",label:"Teacher",type:"select",options:[{value:"",label:"All Teachers"},...v.value.map(s=>({value:s.id,label:`${s.first_name||""} ${s.last_name||""}`.trim()||s.email}))]},{key:"student_id",label:"Student",type:"select",options:[{value:"",label:"All Students"},...b.value.map(s=>({value:s.id,label:`${s.first_name||""} ${s.last_name||""}`.trim()||s.email}))]},{key:"type",label:"Type",type:"select",options:[{value:"",label:"All Types"},{value:"regular",label:"Regular"},{value:"makeup",label:"Makeup"},{value:"trial",label:"Trial"}]}],T=async()=>{p.value=!0;try{const{data:s}=await m.get("/class");i.value=Array.isArray(s.classes||s)?(s.classes||s).map(e=>({...e,teacher:e.teacher?`${e.teacher.first_name||""} ${e.teacher.last_name||""}`.trim()||e.teacher.email:"N/A",student:e.student?`${e.student.first_name||""} ${e.student.last_name||""}`.trim()||e.student.email:"N/A",book:e.book?.title||"N/A",schedule:e.start_time?`${new Date(e.start_time).toLocaleDateString()} ${new Date(e.start_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:"N/A",status:e.status||(e.completed?"completed":"scheduled")})):[]}catch(s){console.error("Error fetching classes:",s),i.value=[]}finally{p.value=!1}},j=async()=>{try{const[s,e]=await Promise.all([m.get("/teacher").catch(()=>({data:{teachers:[]}})),m.get("/students").catch(()=>({data:[]}))]);v.value=s.data?.teachers||s.data||[],b.value=Array.isArray(e.data)?e.data:e.data?.students||[]}catch(s){console.error("Error fetching options:",s)}},N=async()=>{try{const{data:s}=await m.get("/dashboard/stats");x.value=s?.stats||{}}catch(s){console.error("Error fetching stats:",s)}},E=s=>{$.visit(`/super-admin/classes/${s.id}`)},R=s=>{const e=g.map(y=>y.label).join(","),a=s.map(y=>g.map(B=>{const D=y[B.key]||"";return`"${String(D).replace(/"/g,'""')}"`}).join(",")).join(`
`),k=`${e}
${a}`,V=new Blob([k],{type:"text/csv"}),w=window.URL.createObjectURL(V),f=document.createElement("a");f.href=w,f.download=`classes-${new Date().toISOString().split("T")[0]}.csv`,f.click(),window.URL.revokeObjectURL(w)};return O(()=>{j(),T(),N()}),(s,e)=>(c(),_(I,null,[l(n(U),{title:"Classes Management"}),l(G,null,{default:r(()=>[t("div",Y,[t("div",Z,[e[2]||(e[2]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900"},"Classes Management"),t("p",{class:"mt-1 text-sm text-gray-500"}," View and manage all scheduled classes ")],-1)),l(J,{onClick:e[0]||(e[0]=()=>n($).visit("/super-admin/classes/create")),variant:"primary"},{default:r(()=>[l(n(K),{class:"h-5 w-5 mr-2"}),e[1]||(e[1]=h(" Create Class ",-1))]),_:1})]),t("div",ee,[l(u,{class:"p-6"},{default:r(()=>[t("div",te,[t("div",null,[e[3]||(e[3]=t("p",{class:"text-sm font-medium text-gray-600"},"Total Classes",-1)),t("p",se,o(x.value?.totalClasses||i.value.length),1),e[4]||(e[4]=t("p",{class:"mt-1 text-xs text-green-600"},"+8% from last month",-1))]),t("div",ae,[l(n(C),{class:"h-8 w-8 text-blue-600"})])])]),_:1}),l(u,{class:"p-6"},{default:r(()=>[t("div",le,[t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm font-medium text-gray-600"},"Scheduled",-1)),t("p",re,o(i.value.filter(a=>a.status==="scheduled").length),1),e[6]||(e[6]=t("p",{class:"mt-1 text-xs text-gray-500"},"Upcoming",-1))]),t("div",oe,[l(n(P),{class:"h-8 w-8 text-yellow-600"})])])]),_:1}),l(u,{class:"p-6"},{default:r(()=>[t("div",ne,[t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm font-medium text-gray-600"},"Completed",-1)),t("p",ie,o(i.value.filter(a=>a.status==="completed").length),1),e[8]||(e[8]=t("p",{class:"mt-1 text-xs text-gray-500"},"This month",-1))]),t("div",de,[l(n(Q),{class:"h-8 w-8 text-green-600"})])])]),_:1}),l(u,{class:"p-6"},{default:r(()=>[t("div",ce,[t("div",null,[e[9]||(e[9]=t("p",{class:"text-sm font-medium text-gray-600"},"Cancelled",-1)),t("p",ue,o(i.value.filter(a=>a.status==="cancelled").length),1),e[10]||(e[10]=t("p",{class:"mt-1 text-xs text-gray-500"},"This month",-1))]),t("div",me,[l(n(W),{class:"h-8 w-8 text-red-600"})])])]),_:1})]),p.value?(c(),_("div",$e,[...e[11]||(e[11]=[t("div",{class:"h-64 rounded-xl bg-gray-200 animate-pulse"},null,-1)])])):(c(),M(H,{key:0,title:"All Classes",columns:g,data:i.value,searchable:!0,paginated:!0,exportable:!0,filters:S,"items-per-page":25,"row-key":"id",onExport:R},{"cell-class_info":r(({row:a})=>[t("div",pe,[t("div",ge,[l(n(C),{class:"h-5 w-5 text-white"})]),t("div",null,[t("div",fe,"Class #"+o(a.id||"N/A"),1),a.duration?(c(),_("div",ye,o(a.duration)+" minutes",1)):F("",!0)])])]),"cell-teacher":r(({row:a})=>[t("div",_e,[l(n(z),{class:"h-4 w-4 text-gray-400"}),t("span",he,o(a.teacher),1)])]),"cell-student":r(({row:a})=>[t("div",xe,[l(n(q),{class:"h-4 w-4 text-gray-400"}),t("span",ve,o(a.student),1)])]),"cell-book":r(({row:a})=>[t("div",be,o(a.book||"—"),1)]),"cell-schedule":r(({row:a})=>[t("div",ke,o(a.schedule||"—"),1)]),"cell-type":r(({row:a})=>[l(A,{variant:a.type==="regular"?"primary":a.type==="makeup"?"warning":"secondary"},{default:r(()=>[h(o(a.type||"regular"),1)]),_:2},1032,["variant"])]),"cell-status":r(({row:a})=>[l(A,{variant:a.status==="completed"?"success":a.status==="scheduled"?"primary":"danger"},{default:r(()=>[h(o(a.status||"scheduled"),1)]),_:2},1032,["variant"])]),"row-actions":r(({row:a})=>[t("button",{onClick:k=>E(a),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-blue-600 transition-colors",title:"View Details"},[l(n(X),{class:"h-5 w-5"})],8,we)]),_:1},8,["data"]))])]),_:1})],64))}};export{Fe as default};
