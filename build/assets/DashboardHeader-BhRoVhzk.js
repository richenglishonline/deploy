import{l as k,m as i,r as p,o as C,c as a,d as s,t as l,e as d,b as x,u as y,F as j,g as N,s as F,j as $,f as r}from"./app-C5n5MEBy.js";import{a as v}from"./api-DyaYUT2x.js";import{g as A,h as B}from"./AuthenticatedLayout-CuJFiyfd.js";const D={class:"flex items-center justify-between p-4 bg-white shadow-md rounded-lg w-full mb-3"},V={class:"flex items-center gap-4"},z=["title"],I={class:"text-xl font-semibold text-gray-900 truncate"},L={class:"relative"},M={key:0,class:"absolute -top-1 -right-1 rounded-full bg-red-500 text-white w-5 h-5 text-xs flex items-center justify-center"},S={key:0,class:"absolute right-0 mt-2 w-80 max-h-96 overflow-y-auto bg-white rounded-lg shadow-lg border border-gray-200 z-50"},U={class:"p-2"},E=["onClick"],H={class:"flex justify-between items-center"},P={class:"text-sm font-medium text-gray-900"},R=["onClick"],q={key:0,class:"text-xs text-gray-600 truncate"},G={key:1,class:"text-xs text-gray-700"},J={key:2,class:"text-[10px] text-gray-400"},W={__name:"DashboardHeader",setup(K){const u=k(),c=i(()=>u.props.auth?.user?.name??"User"),f=i(()=>u.props.auth?.user?.id),n=p([]),g=p(!1),_=i(()=>n.value.filter(t=>!t.is_read).length),h=async()=>{if(f.value){g.value=!0;try{const{data:t}=await v.get("/notification");n.value=Array.isArray(t)?t:[]}catch(t){console.error("Failed to load notifications:",t)}finally{g.value=!1}}},m=async t=>{try{await v.patch(`/notification/${t}`,{is_read:!0});const o=n.value.findIndex(e=>e.id===t);o!==-1&&(n.value[o].is_read=!0)}catch(o){console.error("Failed to mark notification as read:",o)}},b=i(()=>c.value.split(" ").map(t=>t[0]).slice(0,2).join("").toUpperCase());return C(()=>{h()}),(t,o)=>(r(),a("div",D,[s("div",V,[s("div",{class:"flex items-center justify-center w-12 h-12 rounded-full bg-indigo-600 text-white font-semibold text-lg",title:c.value},l(b.value),9,z),s("h1",I,l(c.value),1)]),s("div",L,[s("button",{class:"relative p-2 rounded-full hover:bg-gray-100 transition-colors",onClick:h},[x(y(A),{class:"w-6 h-6 text-gray-700"}),_.value>0?(r(),a("span",M,l(_.value),1)):d("",!0)]),n.value.length>0?(r(),a("div",S,[s("div",U,[o[0]||(o[0]=s("div",{class:"font-semibold px-2 py-1 border-b border-gray-200 mb-2"}," Notifications ",-1)),(r(!0),a(j,null,N(n.value,e=>(r(),a("div",{key:e.id,class:F([{"bg-gray-50":!e.is_read,"bg-white":e.is_read},"flex flex-col gap-1 p-2 rounded-md hover:bg-gray-100 cursor-pointer mb-1"]),onClick:w=>m(e.id)},[s("div",H,[s("span",P,l(e.type),1),s("button",{onClick:$(w=>m(e.id),["stop"]),class:"p-1 hover:bg-gray-200 rounded"},[x(y(B),{class:"w-4 h-4 text-gray-400 hover:text-gray-600"})],8,R)]),e.label?(r(),a("span",q,l(e.label),1)):d("",!0),e.message?(r(),a("span",G,l(e.message),1)):d("",!0),e.created_at?(r(),a("span",J,l(new Date(e.created_at).toLocaleString()),1)):d("",!0)],10,E))),128))])])):d("",!0)])]))}};export{W as _};
