import{l as B,r as v,m as i,o as M,c,b as l,u as h,h as N,w as S,d as s,f as r,F as u,g as p,p as T}from"./app-DIgTi3sR.js";import{b as W,d as D,a as P,e as F,_ as j}from"./AuthenticatedLayout-5E3vSrN1.js";import{r as H,_ as L,a as R,b as V,c as z,d as E,e as K,f as O,g as U}from"./DonutChart-BfEvfWIZ.js";import{a as q}from"./api-Ia4mmZAM.js";import{r as G}from"./ClockIcon-ryJfNKFy.js";const J={class:"space-y-6 pb-8"},Q={key:0,class:"space-y-6"},X={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},Y={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},Z={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},I={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},ee={class:"mb-4 flex items-center justify-between"},ae={class:"h-64"},se={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},te={class:"mb-4 flex items-center justify-between"},le={class:"h-64"},oe={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},re={class:"lg:col-span-2"},ne={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},de={class:"h-64"},he={__name:"Dashboard",setup(ie){const y=B(),n=v(!1),o=v(null),g=v(!1),m=i(()=>y.props.auth?.user?.role??"teacher"),b=t=>{const e=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],a={primary:"rgba(59, 130, 246, 0.8)",secondary:"rgba(16, 185, 129, 0.8)"};if(t==="line")return{labels:e,datasets:[{label:"Classes",data:[12,19,15,25,22,18,14],borderColor:a.primary,backgroundColor:a.primary.replace("0.8","0.1"),fill:!0,tension:.4},{label:"Attendance",data:[8,15,12,20,18,14,10],borderColor:a.secondary,backgroundColor:a.secondary.replace("0.8","0.1"),fill:!0,tension:.4}]};if(t==="bar")return{labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"Hours",data:[20,25,22,28],backgroundColor:a.primary,borderRadius:8}]};if(t==="pie")return{labels:["Completed","Pending","Cancelled"],datasets:[{data:[65,25,10],backgroundColor:[a.secondary,"rgba(251, 191, 36, 0.8)","rgba(239, 68, 68, 0.8)"]}]};if(t==="donut")return{labels:["Active","Inactive"],datasets:[{data:[75,25],backgroundColor:[a.primary,"rgba(156, 163, 175, 0.8)"]}]}},f=i(()=>{if(!o.value||m.value!=="teacher")return[];const e=(o.value.stats??{}).dashboard??{},a=e.students??0,_=Array.isArray(e.activeClass)?e.activeClass.filter(d=>d!==null).length:e.activeClass&&e.activeClass!==null?1:0,w=Array.isArray(e.todayAttendance)?e.todayAttendance.filter(d=>d!==null).length:e.todayAttendance&&e.todayAttendance!==null?1:0,$=Array.isArray(e.pendingMakeups)?e.pendingMakeups.filter(d=>d!==null).length:e.pendingMakeups&&e.pendingMakeups!==null?1:0;return[{label:"Total Students",value:a,icon:W,iconBgColor:"bg-blue-50",iconColor:"text-blue-600",change:12},{label:"Active Classes",value:_,icon:D,iconBgColor:"bg-green-50",iconColor:"text-green-600",change:8},{label:"Today's Attendance",value:w,icon:P,iconBgColor:"bg-yellow-50",iconColor:"text-yellow-600",change:5},{label:"Pending Makeups",value:$,icon:G,iconBgColor:"bg-red-50",iconColor:"text-red-600",change:-3}]}),C=i(()=>o.value?((o.value.dashboard??{}).activeClass?.slice(0,5)??[]).map((a,_)=>({title:`Class with ${a.student||"Student"}`,description:a.book||"No book assigned",time:`${a.start_time||"N/A"} - ${a.end_time||"N/A"}`,icon:H,iconBg:"bg-green-50",iconColor:"text-green-600"})):[]),k=i(()=>[{key:"student",label:"Student"},{key:"book",label:"Book"},{key:"start_time",label:"Time"},{key:"type",label:"Type"}]),x=i(()=>!o.value||m.value!=="teacher"?[]:((o.value.dashboard??{}).activeClass??[]).map(e=>({student:e.student||"N/A",book:e.book||"N/A",start_time:e.start_time||"N/A",type:e.type||"N/A"}))),A=async()=>{if(!(n.value||g.value)){n.value=!0;try{const{data:t}=await q.get("/dashboard/stats");o.value=t,g.value=!0}catch(t){console.error("Dashboard stats error:",t),t.response?.status===401&&console.warn("Unauthorized - user may need to re-login")}finally{n.value=!1}}};return M(()=>{!g.value&&!n.value&&A()}),(t,e)=>(r(),c(u,null,[l(h(N),{title:"Dashboard"}),l(j,null,{default:S(()=>[s("div",J,[l(L),n.value?(r(),c("div",Q,[s("div",X,[(r(),c(u,null,p(4,a=>s("div",{key:a,class:"h-32 rounded-xl bg-gray-200 animate-pulse"})),64))]),e[0]||(e[0]=s("div",{class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},[s("div",{class:"h-96 rounded-xl bg-gray-200 animate-pulse"}),s("div",{class:"h-96 rounded-xl bg-gray-200 animate-pulse"})],-1))])):(r(),c(u,{key:1},[s("div",Y,[(r(!0),c(u,null,p(f.value,a=>(r(),T(R,{key:a.label,label:a.label,value:a.value,icon:a.icon,"icon-bg-color":a.iconBgColor,"icon-color":a.iconColor,change:a.change,trend:!0},null,8,["label","value","icon","icon-bg-color","icon-color","change"]))),128))]),s("div",Z,[s("div",I,[s("div",ee,[e[1]||(e[1]=s("h3",{class:"text-lg font-semibold text-gray-900"}," Weekly Performance ",-1)),l(h(F),{class:"h-5 w-5 text-gray-400"})]),s("div",ae,[l(V,{data:b("line")},null,8,["data"])])]),s("div",se,[s("div",te,[e[2]||(e[2]=s("h3",{class:"text-lg font-semibold text-gray-900"}," Monthly Hours ",-1)),l(h(z),{class:"h-5 w-5 text-gray-400"})]),s("div",le,[l(E,{data:b("bar")},null,8,["data"])])])]),s("div",oe,[s("div",re,[l(K,{activities:C.value},null,8,["activities"])]),s("div",ne,[e[3]||(e[3]=s("div",{class:"mb-4"},[s("h3",{class:"text-lg font-semibold text-gray-900"}," Class Status "),s("p",{class:"mt-1 text-sm text-gray-500"}," Overview of class distribution ")],-1)),s("div",de,[l(O,{data:b("donut")},null,8,["data"])])])]),l(U,{title:"Recent Classes",columns:k.value,data:x.value,searchable:!0,paginated:!0,"items-per-page":5},null,8,["columns","data"])],64))])]),_:1})],64))}};export{he as default};
