import{l as B,m as D,r as u,a as m,o as P,c as r,b as v,u as f,h as N,w as y,d as e,k as S,q as V,e as g,f as i,F as b,g as j,t as d,i as M,j as h}from"./app-CT2OzWMs.js";import{_ as F}from"./AuthenticatedLayout-BckPqv0C.js";import{a as _}from"./api-BzWpn17H.js";const T={class:"py-10"},L={class:"mx-auto max-w-7xl space-y-6 px-4 sm:px-6 lg:px-8"},U={class:"grid gap-6 lg:grid-cols-3"},q={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm lg:col-span-2"},A={class:"mb-4 flex items-center gap-3"},E=["disabled"],I={class:"overflow-hidden rounded-lg border border-gray-200"},z={class:"overflow-x-auto"},G={class:"min-w-full divide-y divide-gray-200"},H={class:"divide-y divide-gray-200 bg-white"},J={key:0},K={class:"px-6 py-4"},O={class:"font-medium text-gray-900"},Q={class:"px-6 py-4"},R={class:"px-6 py-4"},W={class:"px-6 py-4 text-right"},X={class:"flex items-center justify-end gap-2"},Y=["onClick"],Z=["href"],ee=["onClick","disabled"],te={key:0,class:"flex flex-col items-center justify-between gap-4 border-t border-gray-100 px-6 py-4 text-sm text-gray-600 sm:flex-row"},se={class:"flex items-center gap-2"},oe=["disabled"],ae=["disabled"],ne={__name:"Index",setup(le){const w=B(),k=D(()=>w.props.auth?.user?.role==="super-admin"),l=u(!1),p=u([]),a=u(null),n=m({search:"",page:1,limit:10});u(null),m({title:"",file:null});const c=async()=>{l.value=!0;try{const{data:s}=await _.get("/books",{params:n});p.value=s.books,a.value=s.pagination}catch(s){console.error(s)}finally{l.value=!1}},x=s=>{a.value&&(s<1||s>a.value.totalPages||(n.page=s,c()))},C=async s=>{if(confirm(`Delete ${s.title}?`))try{l.value=!0,await _.delete(`/books/${s.id}`),await c()}catch(t){console.error(t)}finally{l.value=!1}};return P(c),(s,t)=>(i(),r(b,null,[v(f(N),{title:"Books"}),v(F,null,{header:y(()=>[...t[4]||(t[4]=[e("div",{class:"flex items-center justify-between"},[e("div",null,[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Books "),e("p",{class:"text-sm text-gray-500"}," Manage lesson materials, download resources, and upload new content. ")])],-1)])]),default:y(()=>[e("div",T,[e("div",L,[e("div",U,[e("div",q,[e("div",A,[S(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>n.search=o),type:"text",class:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Search title or filename"},null,512),[[V,n.search]]),e("button",{onClick:c,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:l.value}," Search ",8,E)]),e("div",I,[e("div",z,[e("table",G,[t[6]||(t[6]=e("thead",{class:"bg-gray-50"},[e("tr",{class:"text-left text-xs font-semibold uppercase tracking-wider text-gray-500"},[e("th",{scope:"col",class:"px-6 py-3"}," Title "),e("th",{scope:"col",class:"px-6 py-3"}," Filename "),e("th",{scope:"col",class:"px-6 py-3"}," Uploaded "),e("th",{scope:"col",class:"px-6 py-3"})])],-1)),e("tbody",H,[!l.value&&p.value.length===0?(i(),r("tr",J,[...t[5]||(t[5]=[e("td",{colspan:"4",class:"px-6 py-4 text-center text-sm text-gray-500"}," No books found. ",-1)])])):g("",!0),(i(!0),r(b,null,j(p.value,o=>(i(),r("tr",{key:o.id,class:"text-sm text-gray-700"},[e("td",K,[e("div",O,d(o.title),1)]),e("td",Q,d(o.original_filename??o.filename),1),e("td",R,d(o.created_at?new Date(o.created_at).toLocaleDateString():"â€”"),1),e("td",W,[e("div",X,[e("button",{onClick:$=>f(M).visit(s.route("books.show",o.id)),class:"rounded-md bg-blue-600 px-3 py-1.5 text-xs font-medium text-white hover:bg-blue-700"}," View ",8,Y),k.value?(i(),r("a",{key:0,href:`/storage/${o.path}`,target:"_blank",class:"rounded-md border border-gray-300 px-3 py-1 text-xs font-semibold text-gray-700 hover:bg-gray-50",onClick:t[1]||(t[1]=h(()=>{},["stop"]))}," Download ",8,Z)):g("",!0),e("button",{onClick:h($=>C(o),["stop"]),class:"rounded-md border border-red-300 px-3 py-1 text-xs font-semibold text-red-600 hover:bg-red-50",disabled:l.value}," Delete ",8,ee)])])]))),128))])])]),a.value?(i(),r("div",te,[e("div",null," Page "+d(a.value.page)+" of "+d(a.value.totalPages??1),1),e("div",se,[e("button",{onClick:t[2]||(t[2]=o=>x(a.value.page-1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:l.value||a.value.page===1}," Previous ",8,oe),e("button",{onClick:t[3]||(t[3]=o=>x(a.value.page+1)),class:"rounded-md border border-gray-300 px-3 py-1 hover:bg-gray-50",disabled:l.value||a.value.page===a.value.totalPages}," Next ",8,ae)])])):g("",!0)])])])])])]),_:1})],64))}};export{ne as default};
