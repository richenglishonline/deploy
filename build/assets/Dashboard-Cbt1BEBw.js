import{u as B,r as m,j as d,o as M,c,a as o,b as v,h as N,w as S,d as t,g as l,F as u,q as _,e as T}from"./app-Cmmq__Tw.js";import{e as W,a as D,i as P,d as j,c as F,_ as H}from"./AuthenticatedLayout-B2GbnFPi.js";import{_ as L,a as R,b as V}from"./ActivityTimeline-BBrce6IR.js";import{_ as q}from"./DataTable-Cbupb2Fc.js";import{_ as z}from"./LineChart-_iDqiENw.js";import{_ as E}from"./BarChart-DuQ8OsFy.js";import{_ as K}from"./DonutChart-Bf9t0JUo.js";import{a as O}from"./api-BS-ONIJM.js";import{r as U}from"./CheckCircleIcon-Cn5KpQJI.js";import{r as G}from"./ArrowTrendingUpIcon-BJJ-MGm-.js";import"./ArrowUpIcon-DRFX-h9Y.js";const J={class:"space-y-6 pb-8"},Q={key:0,class:"space-y-6"},X={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},Y={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4"},Z={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},I={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},ee={class:"mb-4 flex items-center justify-between"},ae={class:"h-64"},te={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},se={class:"mb-4 flex items-center justify-between"},oe={class:"h-64"},re={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},le={class:"lg:col-span-2"},ne={class:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200"},ie={class:"h-64"},Ce={__name:"Dashboard",setup(de){const y=B(),n=m(!1),r=m(null),g=m(!1),h=d(()=>y.props.auth?.user?.role??"teacher"),b=s=>{const e=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],a={primary:"rgba(59, 130, 246, 0.8)",secondary:"rgba(16, 185, 129, 0.8)"};if(s==="line")return{labels:e,datasets:[{label:"Classes",data:[12,19,15,25,22,18,14],borderColor:a.primary,backgroundColor:a.primary.replace("0.8","0.1"),fill:!0,tension:.4},{label:"Attendance",data:[8,15,12,20,18,14,10],borderColor:a.secondary,backgroundColor:a.secondary.replace("0.8","0.1"),fill:!0,tension:.4}]};if(s==="bar")return{labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"Hours",data:[20,25,22,28],backgroundColor:a.primary,borderRadius:8}]};if(s==="pie")return{labels:["Completed","Pending","Cancelled"],datasets:[{data:[65,25,10],backgroundColor:[a.secondary,"rgba(251, 191, 36, 0.8)","rgba(239, 68, 68, 0.8)"]}]};if(s==="donut")return{labels:["Active","Inactive"],datasets:[{data:[75,25],backgroundColor:[a.primary,"rgba(156, 163, 175, 0.8)"]}]}},f=d(()=>{if(!r.value||h.value!=="teacher")return[];const e=(r.value.stats??{}).dashboard??{},a=e.students??0,p=Array.isArray(e.activeClass)?e.activeClass.filter(i=>i!==null).length:e.activeClass&&e.activeClass!==null?1:0,w=Array.isArray(e.todayAttendance)?e.todayAttendance.filter(i=>i!==null).length:e.todayAttendance&&e.todayAttendance!==null?1:0,$=Array.isArray(e.pendingMakeups)?e.pendingMakeups.filter(i=>i!==null).length:e.pendingMakeups&&e.pendingMakeups!==null?1:0;return[{label:"Total Students",value:a,icon:W,iconBgColor:"bg-blue-50",iconColor:"text-blue-600",change:12},{label:"Active Classes",value:p,icon:D,iconBgColor:"bg-green-50",iconColor:"text-green-600",change:8},{label:"Today's Attendance",value:w,icon:P,iconBgColor:"bg-yellow-50",iconColor:"text-yellow-600",change:5},{label:"Pending Makeups",value:$,icon:j,iconBgColor:"bg-red-50",iconColor:"text-red-600",change:-3}]}),C=d(()=>r.value?((r.value.dashboard??{}).activeClass?.slice(0,5)??[]).map((a,p)=>({title:`Class with ${a.student||"Student"}`,description:a.book||"No book assigned",time:`${a.start_time||"N/A"} - ${a.end_time||"N/A"}`,icon:U,iconBg:"bg-green-50",iconColor:"text-green-600"})):[]),k=d(()=>[{key:"student",label:"Student"},{key:"book",label:"Book"},{key:"start_time",label:"Time"},{key:"type",label:"Type"}]),x=d(()=>!r.value||h.value!=="teacher"?[]:((r.value.dashboard??{}).activeClass??[]).map(e=>({student:e.student||"N/A",book:e.book||"N/A",start_time:e.start_time||"N/A",type:e.type||"N/A"}))),A=async()=>{if(!(n.value||g.value)){n.value=!0;try{const{data:s}=await O.get("/dashboard/stats");r.value=s,g.value=!0}catch(s){console.error("Dashboard stats error:",s),s.response?.status===401&&console.warn("Unauthorized - user may need to re-login")}finally{n.value=!1}}};return M(()=>{!g.value&&!n.value&&A()}),(s,e)=>(l(),c(u,null,[o(v(N),{title:"Dashboard"}),o(H,null,{default:S(()=>[t("div",J,[o(L),n.value?(l(),c("div",Q,[t("div",X,[(l(),c(u,null,_(4,a=>t("div",{key:a,class:"h-32 rounded-xl bg-gray-200 animate-pulse"})),64))]),e[0]||(e[0]=t("div",{class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},[t("div",{class:"h-96 rounded-xl bg-gray-200 animate-pulse"}),t("div",{class:"h-96 rounded-xl bg-gray-200 animate-pulse"})],-1))])):(l(),c(u,{key:1},[t("div",Y,[(l(!0),c(u,null,_(f.value,a=>(l(),T(R,{key:a.label,label:a.label,value:a.value,icon:a.icon,"icon-bg-color":a.iconBgColor,"icon-color":a.iconColor,change:a.change,trend:!0},null,8,["label","value","icon","icon-bg-color","icon-color","change"]))),128))]),t("div",Z,[t("div",I,[t("div",ee,[e[1]||(e[1]=t("h3",{class:"text-lg font-semibold text-gray-900"}," Weekly Performance ",-1)),o(v(F),{class:"h-5 w-5 text-gray-400"})]),t("div",ae,[o(z,{data:b("line")},null,8,["data"])])]),t("div",te,[t("div",se,[e[2]||(e[2]=t("h3",{class:"text-lg font-semibold text-gray-900"}," Monthly Hours ",-1)),o(v(G),{class:"h-5 w-5 text-gray-400"})]),t("div",oe,[o(E,{data:b("bar")},null,8,["data"])])])]),t("div",re,[t("div",le,[o(V,{activities:C.value},null,8,["activities"])]),t("div",ne,[e[3]||(e[3]=t("div",{class:"mb-4"},[t("h3",{class:"text-lg font-semibold text-gray-900"}," Class Status "),t("p",{class:"mt-1 text-sm text-gray-500"}," Overview of class distribution ")],-1)),t("div",ie,[o(K,{data:b("donut")},null,8,["data"])])])]),o(q,{title:"Recent Classes",columns:k.value,data:x.value,searchable:!0,paginated:!0,"items-per-page":5},null,8,["columns","data"])],64))])]),_:1})],64))}};export{Ce as default};
