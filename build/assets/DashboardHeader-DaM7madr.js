import{c as a,d as s,f as r,l as C,m as d,r as p,o as j,t as n,e as i,b as x,u as v,F as A,g as N,s as B,j as F}from"./app-CqMAm5wH.js";import{a as y}from"./api-DzXf9D7P.js";import{i as V}from"./AuthenticatedLayout-DuFXXGSV.js";function $(f,c){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"})])}const D={class:"flex items-center justify-between p-4 bg-white shadow-md rounded-lg w-full mb-3"},M={class:"flex items-center gap-4"},z=["title"],I={class:"text-xl font-semibold text-gray-900 truncate"},L={class:"relative"},S={key:0,class:"absolute -top-1 -right-1 rounded-full bg-red-500 text-white w-5 h-5 text-xs flex items-center justify-center"},U={key:0,class:"absolute right-0 mt-2 w-80 max-h-96 overflow-y-auto bg-white rounded-lg shadow-lg border border-gray-200 z-50"},E={class:"p-2"},H=["onClick"],P={class:"flex justify-between items-center"},R={class:"text-sm font-medium text-gray-900"},q=["onClick"],G={key:0,class:"text-xs text-gray-600 truncate"},J={key:1,class:"text-xs text-gray-700"},K={key:2,class:"text-[10px] text-gray-400"},W={__name:"DashboardHeader",setup(f){const c=C(),u=d(()=>c.props.auth?.user?.name??"User"),b=d(()=>c.props.auth?.user?.id),l=p([]),g=p(!1),h=d(()=>l.value.filter(t=>!t.is_read).length),_=async()=>{if(b.value){g.value=!0;try{const{data:t}=await y.get("/notification");l.value=Array.isArray(t)?t:[]}catch(t){console.error("Failed to load notifications:",t)}finally{g.value=!1}}},m=async t=>{try{await y.patch(`/notification/${t}`,{is_read:!0});const o=l.value.findIndex(e=>e.id===t);o!==-1&&(l.value[o].is_read=!0)}catch(o){console.error("Failed to mark notification as read:",o)}},w=d(()=>u.value.split(" ").map(t=>t[0]).slice(0,2).join("").toUpperCase());return j(()=>{_()}),(t,o)=>(r(),a("div",D,[s("div",M,[s("div",{class:"flex items-center justify-center w-12 h-12 rounded-full bg-indigo-600 text-white font-semibold text-lg",title:u.value},n(w.value),9,z),s("h1",I,n(u.value),1)]),s("div",L,[s("button",{class:"relative p-2 rounded-full hover:bg-gray-100 transition-colors",onClick:_},[x(v($),{class:"w-6 h-6 text-gray-700"}),h.value>0?(r(),a("span",S,n(h.value),1)):i("",!0)]),l.value.length>0?(r(),a("div",U,[s("div",E,[o[0]||(o[0]=s("div",{class:"font-semibold px-2 py-1 border-b border-gray-200 mb-2"}," Notifications ",-1)),(r(!0),a(A,null,N(l.value,e=>(r(),a("div",{key:e.id,class:B([{"bg-gray-50":!e.is_read,"bg-white":e.is_read},"flex flex-col gap-1 p-2 rounded-md hover:bg-gray-100 cursor-pointer mb-1"]),onClick:k=>m(e.id)},[s("div",P,[s("span",R,n(e.type),1),s("button",{onClick:F(k=>m(e.id),["stop"]),class:"p-1 hover:bg-gray-200 rounded"},[x(v(V),{class:"w-4 h-4 text-gray-400 hover:text-gray-600"})],8,q)]),e.label?(r(),a("span",G,n(e.label),1)):i("",!0),e.message?(r(),a("span",J,n(e.message),1)):i("",!0),e.created_at?(r(),a("span",K,n(new Date(e.created_at).toLocaleString()),1)):i("",!0)],10,H))),128))])])):i("",!0)])]))}};export{W as _};
