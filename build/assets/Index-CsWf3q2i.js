import{c as _,d as e,g as m,u as N,r as p,o as R,a as r,b as n,h as S,w as l,e as F,f as d,t as o,k as I,F as P,i as A}from"./app-r5F7AQbe.js";import{l as V,_ as O}from"./AuthenticatedLayout-CNSH0xWk.js";import{_ as z}from"./AdvancedTable-DeA0jASj.js";import{_ as J}from"./Button-BteD-aKC.js";import{_ as $}from"./Badge-l3XqjddH.js";import{_ as x}from"./Card-2P4Rmxrj.js";import{a as b}from"./api-COcabK3_.js";import{r as Z}from"./PlusIcon-CK8Kq6zK.js";import{r as q}from"./PencilIcon-DX4mYHXI.js";import{r as G}from"./TrashIcon-Q9E64JkZ.js";import{r as H}from"./GlobeAltIcon-FjP1nmGI.js";import"./ArrowDownTrayIcon-DZwgirt0.js";import"./ArrowUpIcon-BRIgdKK5.js";function w(j,u){return m(),_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}const K={class:"space-y-6 pb-8"},Q={class:"flex items-center justify-between"},W={class:"grid grid-cols-1 gap-6 sm:grid-cols-3"},X={class:"flex items-center justify-between"},Y={class:"mt-2 text-3xl font-semibold text-gray-900"},ee={class:"rounded-lg bg-blue-50 p-3"},te={class:"flex items-center justify-between"},se={class:"mt-2 text-3xl font-semibold text-gray-900"},ae={class:"rounded-lg bg-green-50 p-3"},re={class:"flex items-center justify-between"},le={class:"mt-2 text-3xl font-semibold text-gray-900"},ne={class:"rounded-lg bg-purple-50 p-3"},oe={class:"flex items-center gap-3"},ie={class:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-purple-600"},ce={class:"text-sm font-semibold text-white"},de={class:"font-medium text-gray-900"},me={key:0,class:"text-xs text-gray-500"},ue={class:"flex items-center gap-2 text-gray-900"},pe={class:"flex items-center gap-2 text-gray-900"},_e={class:"flex items-center justify-end gap-2"},ge=["onClick"],fe=["onClick"],he={key:1,class:"space-y-4"},Ue={__name:"Index",setup(j){N();const u=p(!1),c=p([]);p("");const g=p([]),f=[{key:"name",label:"Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"country",label:"Country",sortable:!0},{key:"timezone",label:"Timezone",sortable:!0},{key:"created_at",label:"Joined",sortable:!0,format:"date"},{key:"assigned_teachers_count",label:"Assigned Teachers",sortable:!0,align:"center"}],C=[{key:"country",label:"Country",type:"select",options:[{value:"",label:"All Countries"},{value:"Philippines",label:"Philippines"},{value:"USA",label:"USA"},{value:"India",label:"India"}]}],h=async()=>{u.value=!0;try{const{data:s}=await b.get("/teacher",{params:{role:"admin"}}),a=Array.isArray(s.teachers)?s.teachers:Array.isArray(s)?s:[];c.value=a.map(t=>({...t,name:`${t.first_name||""} ${t.last_name||""}`.trim()||t.name||t.email,assigned_teachers_count:t.assigned_teachers?.length||0}))}catch(s){console.error("Error fetching admins:",s),c.value=[]}finally{u.value=!1}},E=s=>{A.visit(`/super-admin/admins/${s.id}`)},B=async s=>{if(confirm(`Are you sure you want to delete ${s.name}?`))try{await b.delete(`/teacher/${s.id}`),await h()}catch(a){console.error("Error deleting admin:",a),alert("Failed to delete admin")}},T=async()=>{if(confirm(`Are you sure you want to delete ${g.value.length} admin(s)?`))try{await Promise.all(g.value.map(s=>b.delete(`/teacher/${s.id}`))),g.value=[],await h()}catch(s){console.error("Error bulk deleting admins:",s),alert("Failed to delete some admins")}},U=s=>{const a=f.map(v=>v.label).join(","),t=s.map(v=>f.map(L=>`"${v[L.key]||""}"`).join(",")).join(`
`),i=`${a}
${t}`,M=new Blob([i],{type:"text/csv"}),k=window.URL.createObjectURL(M),y=document.createElement("a");y.href=k,y.download=`admins-${new Date().toISOString().split("T")[0]}.csv`,y.click(),window.URL.revokeObjectURL(k)},D=()=>{A.visit("/super-admin/admins/create")};return R(()=>{h()}),(s,a)=>(m(),_(P,null,[r(n(S),{title:"Admins Management"}),r(O,null,{default:l(()=>[e("div",K,[e("div",Q,[a[1]||(a[1]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Admins Management"),e("p",{class:"mt-1 text-sm text-gray-500"}," Manage system administrators and their permissions ")],-1)),r(J,{onClick:D,variant:"primary"},{default:l(()=>[r(n(Z),{class:"h-5 w-5 mr-2"}),a[0]||(a[0]=d(" Add Admin ",-1))]),_:1})]),e("div",W,[r(x,{class:"p-6"},{default:l(()=>[e("div",X,[e("div",null,[a[2]||(a[2]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Admins",-1)),e("p",Y,o(c.value.length),1)]),e("div",ee,[r(n(w),{class:"h-8 w-8 text-blue-600"})])])]),_:1}),r(x,{class:"p-6"},{default:l(()=>[e("div",te,[e("div",null,[a[3]||(a[3]=e("p",{class:"text-sm font-medium text-gray-600"},"Active Admins",-1)),e("p",se,o(c.value.filter(t=>t.accepted).length),1)]),e("div",ae,[r(n(w),{class:"h-8 w-8 text-green-600"})])])]),_:1}),r(x,{class:"p-6"},{default:l(()=>[e("div",re,[e("div",null,[a[4]||(a[4]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Assigned Teachers",-1)),e("p",le,o(c.value.reduce((t,i)=>t+(i.assigned_teachers_count||0),0)),1)]),e("div",ne,[r(n(w),{class:"h-8 w-8 text-purple-600"})])])]),_:1})]),u.value?(m(),_("div",he,[...a[5]||(a[5]=[e("div",{class:"h-64 rounded-xl bg-gray-200 animate-pulse"},null,-1)])])):(m(),F(z,{key:0,title:"All Admins",columns:f,data:c.value,searchable:!0,paginated:!0,selectable:!0,exportable:!0,filters:C,"items-per-page":25,"row-key":"id",onExport:U,onBulkDelete:T},{"cell-name":l(({row:t})=>[e("div",oe,[e("div",ie,[e("span",ce,o(t.name.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2)),1)]),e("div",null,[e("div",de,o(t.name),1),t.role?(m(),_("div",me,[r($,{variant:t.role==="super-admin"?"primary":"secondary"},{default:l(()=>[d(o(t.role),1)]),_:2},1032,["variant"])])):I("",!0)])])]),"cell-email":l(({row:t})=>[e("div",ue,[r(n(V),{class:"h-4 w-4 text-gray-400"}),d(" "+o(t.email),1)])]),"cell-country":l(({row:t})=>[e("div",pe,[r(n(H),{class:"h-4 w-4 text-gray-400"}),d(" "+o(t.country||"â€”"),1)])]),"cell-assigned_teachers_count":l(({row:t})=>[r($,{variant:"secondary"},{default:l(()=>[d(o(t.assigned_teachers_count||0),1)]),_:2},1024)]),"row-actions":l(({row:t})=>[e("div",_e,[e("button",{onClick:i=>E(t),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-blue-600 transition-colors",title:"Edit"},[r(n(q),{class:"h-5 w-5"})],8,ge),e("button",{onClick:i=>B(t),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-red-600 transition-colors",title:"Delete"},[r(n(G),{class:"h-5 w-5"})],8,fe)])]),_:1},8,["data"]))])]),_:1})],64))}};export{Ue as default};
