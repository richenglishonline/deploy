import{u as k,r as m,o as w,c as _,a as l,b as c,h as $,w as n,d as e,e as C,t as r,g as d,n as S,y as A,f as V,k as z,F as j,i as T}from"./app-BiSPCPuo.js";import{e as B,a as E,d as M,r as N,_ as U}from"./AuthenticatedLayout-57Q77M7z.js";import{_ as F}from"./AdvancedTable-5fi55ECo.js";import{_ as g}from"./Card-B0sMFwFC.js";import{_ as P}from"./Badge-DAiRCop6.js";import{a as p}from"./api-BtR7IrG5.js";import{r as D}from"./EyeIcon-BomQU5Ge.js";import"./ArrowDownTrayIcon-DICVMDSG.js";import"./ArrowUpIcon-IEJdmouC.js";import"./TrashIcon-DlbRnS0G.js";const I={class:"space-y-6 pb-8"},L={class:"grid grid-cols-1 gap-6 sm:grid-cols-3"},R={class:"flex items-center justify-between"},q={class:"mt-2 text-3xl font-semibold text-gray-900"},G={class:"rounded-lg bg-blue-50 p-3"},H={class:"flex items-center justify-between"},J={class:"mt-2 text-3xl font-semibold text-gray-900"},K={class:"rounded-lg bg-purple-50 p-3"},O={class:"flex items-center justify-between"},Q={class:"mt-2 text-3xl font-semibold text-gray-900"},W={class:"rounded-lg bg-green-50 p-3"},X={class:"flex items-center gap-3"},Y={class:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-green-500 to-teal-600"},Z={class:"text-sm font-semibold text-white"},ee={class:"font-medium text-gray-900"},te={key:0,class:"text-xs text-gray-500"},se={class:"text-gray-900"},ae={class:"text-gray-900"},le={class:"flex items-center gap-2"},ne={class:"font-medium text-gray-900"},re={class:"h-2 w-16 rounded-full bg-gray-200"},oe=["onClick"],ie={key:1,class:"space-y-4"},be={__name:"Index",setup(ce){k();const u=m(!1),o=m([]),f=m(null),y=[{key:"name",label:"Student",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"country",label:"Country",sortable:!0},{key:"timezone",label:"Timezone",sortable:!0},{key:"classes_count",label:"Total Classes",sortable:!0,align:"center"},{key:"attendance_rate",label:"Attendance Rate",sortable:!0,align:"center",format:"percentage"},{key:"last_class",label:"Last Class",sortable:!0,format:"date"}],h=[{key:"country",label:"Country",type:"select",options:[{value:"",label:"All Countries"},{value:"Philippines",label:"Philippines"},{value:"USA",label:"USA"}]}],x=async()=>{u.value=!0;try{const{data:a}=await p.get("/teacher/students");o.value=Array.isArray(a)?a.map(s=>({...s,name:`${s.first_name||""} ${s.last_name||""}`.trim()||s.email||"Unnamed Student",classes_count:s.classes?.length||0,attendance_rate:s.attendance_rate||0,last_class:s.last_class_date||null})):[]}catch(a){console.error("Error fetching students:",a),o.value=[]}finally{u.value=!1}},b=async()=>{try{const{data:a}=await p.get("/dashboard/stats");f.value=a?.dashboard||{}}catch(a){console.error("Error fetching stats:",a)}},v=a=>{T.visit(`/teacher/students/${a.id}`)};return w(()=>{x(),b()}),(a,s)=>(d(),_(j,null,[l(c($),{title:"My Students"}),l(U,null,{default:n(()=>[e("div",I,[s[4]||(s[4]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"My Students"),e("p",{class:"mt-1 text-sm text-gray-500"}," View and manage your assigned students ")],-1)),e("div",L,[l(g,{class:"p-6"},{default:n(()=>[e("div",R,[e("div",null,[s[0]||(s[0]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Students",-1)),e("p",q,r(o.value.length),1)]),e("div",G,[l(c(B),{class:"h-8 w-8 text-blue-600"})])])]),_:1}),l(g,{class:"p-6"},{default:n(()=>[e("div",H,[e("div",null,[s[1]||(s[1]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Classes",-1)),e("p",J,r(o.value.reduce((t,i)=>t+(i.classes_count||0),0)),1)]),e("div",K,[l(c(E),{class:"h-8 w-8 text-purple-600"})])])]),_:1}),l(g,{class:"p-6"},{default:n(()=>[e("div",O,[e("div",null,[s[2]||(s[2]=e("p",{class:"text-sm font-medium text-gray-600"},"Avg Attendance",-1)),e("p",Q,r(o.value.length>0?(o.value.reduce((t,i)=>t+(i.attendance_rate||0),0)/o.value.length).toFixed(1):"0")+"% ",1)]),e("div",W,[l(c(M),{class:"h-8 w-8 text-green-600"})])])]),_:1})]),u.value?(d(),_("div",ie,[...s[3]||(s[3]=[e("div",{class:"h-64 rounded-xl bg-gray-200 animate-pulse"},null,-1)])])):(d(),C(F,{key:0,title:"Assigned Students",columns:y,data:o.value,searchable:!0,paginated:!0,filters:h,"items-per-page":25,"row-key":"id"},{"cell-name":n(({row:t})=>[e("div",X,[e("div",Y,[e("span",Z,r(t.name.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2)),1)]),e("div",null,[e("div",ee,r(t.name),1),t.timezone?(d(),_("div",te,r(t.timezone),1)):z("",!0)])])]),"cell-email":n(({row:t})=>[e("div",se,r(t.email||"—"),1)]),"cell-country":n(({row:t})=>[e("div",ae,r(t.country||"—"),1)]),"cell-classes_count":n(({row:t})=>[l(P,{variant:"secondary"},{default:n(()=>[l(c(N),{class:"h-3 w-3 mr-1 inline"}),V(" "+r(t.classes_count||0),1)]),_:2},1024)]),"cell-attendance_rate":n(({row:t})=>[e("div",le,[e("span",ne,r(t.attendance_rate||0)+"%",1),e("div",re,[e("div",{class:A(["h-2 rounded-full",{"bg-green-500":t.attendance_rate>=90,"bg-yellow-500":t.attendance_rate>=75&&t.attendance_rate<90,"bg-red-500":t.attendance_rate<75}]),style:S({width:`${Math.min(t.attendance_rate||0,100)}%`})},null,6)])])]),"row-actions":n(({row:t})=>[e("button",{onClick:i=>v(t),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-blue-600 transition-colors",title:"View Details"},[l(c(D),{class:"h-5 w-5"})],8,oe)]),_:1},8,["data"]))])]),_:1})],64))}};export{be as default};
