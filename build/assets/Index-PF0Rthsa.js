import{l as O,m as T,r as k,a as S,o as I,c as p,b as l,u as $,h as Y,w as i,d as t,k as b,q as j,v as z,e as v,t as r,f as m,F as q,g as W,n,s as G,j as J,x as M}from"./app-m0EauCUY.js";import{_ as K}from"./AuthenticatedLayout-OkZKskr4.js";import{_ as Q,a as X,b as Z,c as ee}from"./DialogFooter-iu4KPpmI.js";import{_}from"./Button-BNk2yZr1.js";import{_ as c,a as y}from"./Label--RUlagTH.js";import{a as C}from"./api-p6Oc_tdf.js";import{r as te}from"./PencilIcon-B_oA3ZJx.js";import{r as se}from"./TrashIcon-CwPtAs3_.js";import{r as le}from"./PlusIcon-Dag2rNRC.js";const ae={class:"flex items-center justify-between"},oe={class:"text-xl font-semibold leading-tight text-gray-800"},ie={class:"text-sm text-gray-500"},ne={class:"flex items-center gap-3"},de={class:"py-10"},re={class:"mx-auto max-w-7xl space-y-6 px-4 sm:px-6 lg:px-8"},ue={class:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm"},pe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},me={class:"flex items-end gap-3"},ce=["disabled"],ve=["disabled"],fe={class:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm"},ge={class:"overflow-x-auto"},ye={class:"min-w-full divide-y divide-gray-200"},be={class:"bg-gray-50"},xe={class:"text-left text-xs font-semibold uppercase tracking-wider text-gray-500"},_e={scope:"col",class:"px-6 py-3"},he={key:0,scope:"col",class:"px-6 py-3"},we={key:1,scope:"col",class:"px-6 py-3"},ke={key:2,scope:"col",class:"px-6 py-3"},Ve={key:3,scope:"col",class:"px-6 py-3"},Ae={key:4,scope:"col",class:"px-6 py-3"},Ue={class:"divide-y divide-gray-200 bg-white"},$e={key:0},je=["colspan"],Ce={class:"px-6 py-4"},Pe={class:"font-medium text-gray-900"},Te={class:"text-gray-500"},ze={class:"text-xs text-gray-400"},Me={key:0,class:"px-6 py-4"},Ne={class:"text-xs text-gray-500"},De={class:"text-xs text-gray-500"},Ee={key:1,class:"px-6 py-4"},Se={class:"space-y-1 text-xs text-gray-600"},qe={class:"font-medium"},Be={class:"font-medium"},Fe={class:"font-medium"},He={key:2,class:"px-6 py-4"},Re={key:3,class:"px-6 py-4"},Le={class:"px-6 py-4"},Oe={key:4,class:"px-6 py-4"},Ie={class:"flex items-center gap-2"},Ye={key:0,class:"flex flex-col items-center justify-between gap-4 border-t border-gray-100 px-6 py-4 text-sm text-gray-600 sm:flex-row"},We={class:"flex items-center gap-2"},Ge={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Je={class:"space-y-2"},Ke={class:"space-y-2"},Qe={class:"space-y-2"},Xe={class:"space-y-2"},Ze={key:0,class:"text-xs text-muted-foreground"},et={class:"space-y-2"},tt={class:"space-y-2"},st={key:0,class:"space-y-2"},lt={class:"space-y-2"},at={key:0,class:"border-t pt-4"},ot={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},it={class:"space-y-2"},nt={class:"space-y-2"},dt={class:"space-y-2"},rt={class:"space-y-2"},ut={class:"sm:col-span-2 space-y-2"},pt={class:"flex items-center gap-2"},mt={class:"flex items-center gap-2"},ct={class:"flex items-center gap-2"},Vt={__name:"Index",setup(vt){const N=O(),A=T(()=>N.props.filterRole??null),d=T(()=>A.value==="admin"),U=T(()=>N.props.auth?.user?.role==="super-admin"),x=k(!1),P=k([]),f=k(null),w=k(!1),g=k(null),V=k(!1),o=S({first_name:"",last_name:"",email:"",password:"",country:"",timezone:"Asia/Manila",role:A.value||"teacher",accepted:!!d.value,phone:"",degree:"",major:"",english_level:"",availability:"",has_webcam:!1,has_headset:!1,has_backup_internet:!1}),u=S({search:"",country:"",degree:"",major:"",accepted:"",role:A.value,page:1,limit:10}),h=async()=>{x.value=!0;try{const a={...u};d.value||delete a.role;const{data:e}=await C.get("/teacher",{params:a});P.value=e.teachers,f.value=e.pagination}catch(a){console.error(a)}finally{x.value=!1}},D=a=>{f.value&&(a<1||a>f.value.totalPages||(u.page=a,h()))},B=()=>{u.search="",u.country="",u.degree="",u.major="",u.accepted="",u.page=1,d.value?u.role="admin":delete u.role,h()},F=()=>{g.value=null,Object.assign(o,{first_name:"",last_name:"",email:"",password:"",country:"",timezone:"Asia/Manila",role:A.value||"teacher",accepted:!!d.value,phone:"",degree:"",major:"",english_level:"",availability:"",has_webcam:!1,has_headset:!1,has_backup_internet:!1}),w.value=!0},H=a=>{g.value=a;const e=a.name.split(" ");Object.assign(o,{first_name:e[0]||"",last_name:e.slice(1).join(" ")||"",email:a.email||"",password:"",country:a.country||"",timezone:a.timezone||"Asia/Manila",role:a.role,accepted:a.accepted??!1,phone:a.teacher_profile?.phone||"",degree:a.teacher_profile?.degree||"",major:a.teacher_profile?.major||"",english_level:a.teacher_profile?.english_level||"",availability:a.teacher_profile?.availability||"",has_webcam:a.teacher_profile?.has_webcam||!1,has_headset:a.teacher_profile?.has_headset||!1,has_backup_internet:a.teacher_profile?.has_backup_internet||!1}),w.value=!0},R=async a=>{if(confirm(`Are you sure you want to delete ${a.name}? This action cannot be undone.`))try{await C.delete(`/teacher/${a.id}`),await h(),alert(`${d.value?"Admin":"Teacher"} deleted successfully`)}catch(e){console.error("Delete error:",e),alert("Failed to delete. Please try again.")}},L=async()=>{V.value=!0;try{const a={...o};g.value&&!a.password&&delete a.password,g.value?(await C.patch(`/teacher/${g.value.id}`,a),alert(`${d.value?"Admin":"Teacher"} updated successfully`)):(await C.post("/teacher",a),alert(`${d.value?"Admin":"Teacher"} created successfully`)),w.value=!1,await h()}catch(a){console.error("Submit error:",a);const e=a.response?.data?.message||a.message||"Operation failed";alert(e)}finally{V.value=!1}};return I(h),(a,e)=>(m(),p(q,null,[l($(Y),{title:d.value?"Admins":"Teachers"},null,8,["title"]),l(K,null,{header:i(()=>[t("div",ae,[t("div",null,[t("h2",oe,r(d.value?"Admins":"Teachers"),1),t("p",ie,r(d.value?"Manage admin accounts and permissions.":"Review teacher applications, availability, and equipment readiness."),1)]),t("div",ne,[t("button",{onClick:F,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-blue-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 disabled:pointer-events-none disabled:opacity-50"},[l($(le),{class:"h-5 w-5"}),n(" Add "+r(d.value?"Admin":"Teacher"),1)]),l(_,{onClick:h,variant:"outline",disabled:x.value},{default:i(()=>[...e[25]||(e[25]=[n(" Refresh ",-1)])]),_:1},8,["disabled"])])])]),default:i(()=>[t("div",de,[t("div",re,[t("div",ue,[t("form",pe,[t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700"}," Search ",-1)),b(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>u.search=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Name or email"},null,512),[[j,u.search]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700"}," Country ",-1)),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>u.country=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"PH"},null,512),[[j,u.country]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700"}," Degree ",-1)),b(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>u.degree=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"BA English"},null,512),[[j,u.degree]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700"}," Major ",-1)),b(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>u.major=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Linguistics"},null,512),[[j,u.major]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700"}," Accepted ",-1)),b(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>u.accepted=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[...e[30]||(e[30]=[t("option",{value:""},"Any",-1),t("option",{value:"true"},"Accepted",-1),t("option",{value:"false"},"Pending",-1)])],512),[[z,u.accepted]])]),t("div",me,[t("button",{type:"button",onClick:h,class:"flex-1 rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",disabled:x.value}," Apply Filters ",8,ce),t("button",{type:"button",onClick:B,class:"flex-1 rounded-md border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-50",disabled:x.value}," Reset ",8,ve)])])]),t("div",fe,[t("div",ge,[t("table",ye,[t("thead",be,[t("tr",xe,[t("th",_e,r(d.value?"Admin":"Teacher"),1),d.value?v("",!0):(m(),p("th",he," Profile ")),d.value?v("",!0):(m(),p("th",we," Equipment ")),d.value?v("",!0):(m(),p("th",ke," Availability ")),d.value?v("",!0):(m(),p("th",Ve," Assigned Admin ")),e[32]||(e[32]=t("th",{scope:"col",class:"px-6 py-3"}," Status ",-1)),U.value?(m(),p("th",Ae," Actions ")):v("",!0)])]),t("tbody",Ue,[!x.value&&P.value.length===0?(m(),p("tr",$e,[t("td",{colspan:d.value?U.value?3:2:U.value?7:6,class:"px-6 py-4 text-center text-sm text-gray-500"}," No "+r(d.value?"admins":"teachers")+" found. ",9,je)])):v("",!0),(m(!0),p(q,null,W(P.value,s=>(m(),p("tr",{key:s.id,class:"text-sm text-gray-700"},[t("td",Ce,[t("div",Pe,r(s.name),1),t("div",Te,r(s.email),1),t("div",ze,r(s.country),1)]),d.value?v("",!0):(m(),p("td",Me,[t("div",null,r(s.teacher_profile?.degree??"—"),1),t("div",Ne," Major "+r(s.teacher_profile?.major??"—"),1),t("div",De," English Level "+r(s.teacher_profile?.english_level??"—"),1)])),d.value?v("",!0):(m(),p("td",Ee,[t("ul",Se,[t("li",null,[e[33]||(e[33]=n(" Webcam: ",-1)),t("span",qe,r(s.teacher_profile?.has_webcam?"Yes":"No"),1)]),t("li",null,[e[34]||(e[34]=n(" Headset: ",-1)),t("span",Be,r(s.teacher_profile?.has_headset?"Yes":"No"),1)]),t("li",null,[e[35]||(e[35]=n(" Backup Internet: ",-1)),t("span",Fe,r(s.teacher_profile?.has_backup_internet?"Yes":"No"),1)])])])),d.value?v("",!0):(m(),p("td",He,r(s.teacher_profile?.availability??"—"),1)),d.value?v("",!0):(m(),p("td",Re,r(s.teacher_profile?.assigned_admin?.name??"Unassigned"),1)),t("td",Le,[t("span",{class:G(["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",s.accepted?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"])},r(s.accepted?"Active":"Pending"),3)]),U.value?(m(),p("td",Oe,[t("div",Ie,[l(_,{onClick:E=>a.router.visit(a.route(d.value?"admins.show":"teachers.show",s.id)),variant:"outline",size:"sm",class:"flex items-center gap-1",title:"View"},{default:i(()=>[...e[36]||(e[36]=[n(" View ",-1)])]),_:1},8,["onClick"]),l(_,{onClick:E=>H(s),variant:"outline",size:"sm",class:"flex items-center gap-1",title:"Edit"},{default:i(()=>[l($(te),{class:"h-4 w-4"}),e[37]||(e[37]=n(" Edit ",-1))]),_:1},8,["onClick"]),l(_,{onClick:E=>R(s),variant:"destructive",size:"sm",class:"flex items-center gap-1",title:"Delete"},{default:i(()=>[l($(se),{class:"h-4 w-4"}),e[38]||(e[38]=n(" Delete ",-1))]),_:1},8,["onClick"])])])):v("",!0)]))),128))])])]),f.value?(m(),p("div",Ye,[t("div",null," Page "+r(f.value.page)+" of "+r(f.value.totalPages??1),1),t("div",We,[l(_,{onClick:e[5]||(e[5]=s=>D(f.value.page-1)),variant:"outline",size:"sm",disabled:x.value||f.value.page===1},{default:i(()=>[...e[39]||(e[39]=[n(" Previous ",-1)])]),_:1},8,["disabled"]),l(_,{onClick:e[6]||(e[6]=s=>D(f.value.page+1)),variant:"outline",size:"sm",disabled:x.value||f.value.page===f.value.totalPages},{default:i(()=>[...e[40]||(e[40]=[n(" Next ",-1)])]),_:1},8,["disabled"])])])):v("",!0)])])]),l(Q,{open:w.value,"onUpdate:open":e[24]||(e[24]=s=>w.value=s)},{default:i(()=>[l(X,null,{default:i(()=>[l(Z,null,{default:i(()=>[n(r(g.value?`Edit ${d.value?"Admin":"Teacher"}`:`Add ${d.value?"Admin":"Teacher"}`),1)]),_:1})]),_:1}),t("form",{onSubmit:J(L,["prevent"]),class:"space-y-4"},[t("div",Ge,[t("div",Je,[l(c,null,{default:i(()=>[...e[41]||(e[41]=[n(" First Name ",-1),t("span",{class:"text-destructive"},"*",-1)])]),_:1}),l(y,{modelValue:o.first_name,"onUpdate:modelValue":e[7]||(e[7]=s=>o.first_name=s),type:"text",required:""},null,8,["modelValue"])]),t("div",Ke,[l(c,null,{default:i(()=>[...e[42]||(e[42]=[n(" Last Name ",-1),t("span",{class:"text-destructive"},"*",-1)])]),_:1}),l(y,{modelValue:o.last_name,"onUpdate:modelValue":e[8]||(e[8]=s=>o.last_name=s),type:"text",required:""},null,8,["modelValue"])]),t("div",Qe,[l(c,null,{default:i(()=>[...e[43]||(e[43]=[n(" Email ",-1),t("span",{class:"text-destructive"},"*",-1)])]),_:1}),l(y,{modelValue:o.email,"onUpdate:modelValue":e[9]||(e[9]=s=>o.email=s),type:"email",required:""},null,8,["modelValue"])]),t("div",Xe,[l(c,null,{default:i(()=>[e[44]||(e[44]=n(" Password ",-1)),e[45]||(e[45]=t("span",{class:"text-destructive"},"*",-1)),g.value?(m(),p("span",Ze,"(leave blank to keep current)")):v("",!0)]),_:1}),l(y,{modelValue:o.password,"onUpdate:modelValue":e[10]||(e[10]=s=>o.password=s),type:"password",required:!g.value},null,8,["modelValue","required"])]),t("div",et,[l(c,null,{default:i(()=>[...e[46]||(e[46]=[n("Country",-1)])]),_:1}),l(y,{modelValue:o.country,"onUpdate:modelValue":e[11]||(e[11]=s=>o.country=s),type:"text"},null,8,["modelValue"])]),t("div",tt,[l(c,null,{default:i(()=>[...e[47]||(e[47]=[n("Timezone",-1)])]),_:1}),l(y,{modelValue:o.timezone,"onUpdate:modelValue":e[12]||(e[12]=s=>o.timezone=s),type:"text"},null,8,["modelValue"])]),g.value?v("",!0):(m(),p("div",st,[l(c,null,{default:i(()=>[...e[48]||(e[48]=[n(" Role ",-1),t("span",{class:"text-destructive"},"*",-1)])]),_:1}),b(t("select",{"onUpdate:modelValue":e[13]||(e[13]=s=>o.role=s),required:"",class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"},[...e[49]||(e[49]=[t("option",{value:"teacher"},"Teacher",-1),t("option",{value:"admin"},"Admin",-1)])],512),[[z,o.role]])])),t("div",lt,[l(c,null,{default:i(()=>[...e[50]||(e[50]=[n("Status",-1)])]),_:1}),b(t("select",{"onUpdate:modelValue":e[14]||(e[14]=s=>o.accepted=s),class:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"},[...e[51]||(e[51]=[t("option",{value:!1},"Pending",-1),t("option",{value:!0},"Accepted/Active",-1)])],512),[[z,o.accepted]])])]),o.role==="teacher"||!g.value&&!d.value?(m(),p("div",at,[e[60]||(e[60]=t("h4",{class:"text-sm font-medium mb-3"},"Teacher Profile (Optional)",-1)),t("div",ot,[t("div",it,[l(c,null,{default:i(()=>[...e[52]||(e[52]=[n("Phone",-1)])]),_:1}),l(y,{modelValue:o.phone,"onUpdate:modelValue":e[15]||(e[15]=s=>o.phone=s),type:"text"},null,8,["modelValue"])]),t("div",nt,[l(c,null,{default:i(()=>[...e[53]||(e[53]=[n("Degree",-1)])]),_:1}),l(y,{modelValue:o.degree,"onUpdate:modelValue":e[16]||(e[16]=s=>o.degree=s),type:"text"},null,8,["modelValue"])]),t("div",dt,[l(c,null,{default:i(()=>[...e[54]||(e[54]=[n("Major",-1)])]),_:1}),l(y,{modelValue:o.major,"onUpdate:modelValue":e[17]||(e[17]=s=>o.major=s),type:"text"},null,8,["modelValue"])]),t("div",rt,[l(c,null,{default:i(()=>[...e[55]||(e[55]=[n("English Level",-1)])]),_:1}),l(y,{modelValue:o.english_level,"onUpdate:modelValue":e[18]||(e[18]=s=>o.english_level=s),type:"text"},null,8,["modelValue"])]),t("div",ut,[l(c,null,{default:i(()=>[...e[56]||(e[56]=[n("Availability",-1)])]),_:1}),l(y,{modelValue:o.availability,"onUpdate:modelValue":e[19]||(e[19]=s=>o.availability=s),type:"text"},null,8,["modelValue"])]),t("div",pt,[b(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>o.has_webcam=s),type:"checkbox",class:"h-4 w-4 rounded border-input text-primary focus:ring-ring"},null,512),[[M,o.has_webcam]]),l(c,{class:"!mb-0"},{default:i(()=>[...e[57]||(e[57]=[n("Has Webcam",-1)])]),_:1})]),t("div",mt,[b(t("input",{"onUpdate:modelValue":e[21]||(e[21]=s=>o.has_headset=s),type:"checkbox",class:"h-4 w-4 rounded border-input text-primary focus:ring-ring"},null,512),[[M,o.has_headset]]),l(c,{class:"!mb-0"},{default:i(()=>[...e[58]||(e[58]=[n("Has Headset",-1)])]),_:1})]),t("div",ct,[b(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>o.has_backup_internet=s),type:"checkbox",class:"h-4 w-4 rounded border-input text-primary focus:ring-ring"},null,512),[[M,o.has_backup_internet]]),l(c,{class:"!mb-0"},{default:i(()=>[...e[59]||(e[59]=[n("Has Backup Internet",-1)])]),_:1})])])])):v("",!0),l(ee,null,{default:i(()=>[l(_,{type:"button",variant:"outline",onClick:e[23]||(e[23]=s=>w.value=!1),disabled:V.value},{default:i(()=>[...e[61]||(e[61]=[n(" Cancel ",-1)])]),_:1},8,["disabled"]),l(_,{type:"submit",disabled:V.value},{default:i(()=>[n(r(V.value?"Saving...":g.value?"Update":"Create"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1},8,["open"])]),_:1})],64))}};export{Vt as default};
