import{u as D,r as u,j as g,o as N,c as _,a as l,b as d,h as V,w as n,d as e,e as B,f as i,t as r,g as m,F as H,i as x}from"./app-CGuEmW06.js";import{a as h,d as R,_ as T}from"./AuthenticatedLayout-CJGuDV3D.js";import{_ as E}from"./AdvancedTable-C74tgwHJ.js";import{_ as p}from"./Card-O4ACqxyG.js";import{_ as v}from"./Badge-xK72gQ5Q.js";import{_ as M}from"./Button-BBsil_pH.js";import{a as b}from"./api-B9gIEsIZ.js";import{r as L}from"./PlusIcon-CiP_j3xr.js";import{r as P}from"./CheckCircleIcon-QmryU6wr.js";import{r as I}from"./EyeIcon-BaQtjq6r.js";import"./ArrowDownTrayIcon-CC8afiRz.js";import"./ArrowUpIcon-DLRLa_dE.js";import"./TrashIcon-7rQaTgdF.js";const O={class:"space-y-6 pb-8"},U={class:"flex items-center justify-between"},q={class:"grid grid-cols-1 gap-6 sm:grid-cols-3"},z={class:"flex items-center justify-between"},G={class:"mt-2 text-3xl font-semibold text-gray-900"},J={class:"rounded-lg bg-blue-50 p-3"},K={class:"flex items-center justify-between"},Q={class:"mt-2 text-3xl font-semibold text-gray-900"},W={class:"rounded-lg bg-green-50 p-3"},X={class:"flex items-center justify-between"},Y={class:"mt-2 text-3xl font-semibold text-gray-900"},Z={class:"rounded-lg bg-purple-50 p-3"},tt={class:"flex items-center gap-3"},et={class:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-green-500 to-teal-600"},st={class:"text-sm font-semibold text-white"},at={class:"font-medium text-gray-900"},lt={class:"text-gray-900"},nt={class:"flex items-center gap-2 text-gray-900"},rt={class:"text-right font-medium text-gray-900"},ot=["onClick"],dt={key:1,class:"space-y-4"},wt={__name:"Index",setup(it){D();const c=u(!1),o=u([]),y=u(null),k=[{key:"student",label:"Student",sortable:!0},{key:"class",label:"Class",sortable:!0},{key:"date",label:"Date",sortable:!0,format:"date"},{key:"duration",label:"Duration",sortable:!0,align:"center"},{key:"status",label:"Status",sortable:!0,align:"center"},{key:"hours",label:"Hours",sortable:!0,align:"right",format:"number"}],w=[{key:"status",label:"Status",type:"select",options:[{value:"",label:"All Statuses"},{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"late",label:"Late"}]}],$=async()=>{c.value=!0;try{const{data:a}=await b.get("/teacher/attendance");o.value=Array.isArray(a.attendances||a)?(a.attendances||a).map(t=>({...t,student:t.student?`${t.student.first_name||""} ${t.student.last_name||""}`.trim()||t.student.email:"N/A",class:t.class_schedule?`Class #${t.class_schedule.id}`:"N/A",date:t.date||t.class_schedule?.start_time,duration:t.duration?`${t.duration} min`:"N/A",hours:t.hours||(t.duration?(t.duration/60).toFixed(2):0),status:t.status||"present"})):[]}catch(a){console.error("Error fetching attendance:",a),o.value=[]}finally{c.value=!1}},A=async()=>{try{const{data:a}=await b.get("/dashboard/stats");y.value=a?.dashboard||{}}catch(a){console.error("Error fetching stats:",a)}},F=a=>{x.visit(`/teacher/attendance/${a.id}`)},j=()=>{x.visit("/teacher/attendance/mark")},C=g(()=>o.value.reduce((a,t)=>a+(parseFloat(t.hours)||0),0).toFixed(2)),S=g(()=>{const a=o.value.length;return a===0?0:(o.value.filter(s=>s.status==="present").length/a*100).toFixed(1)});return N(()=>{$(),A()}),(a,t)=>(m(),_(H,null,[l(d(V),{title:"Attendance"}),l(T,null,{default:n(()=>[e("div",O,[e("div",U,[t[1]||(t[1]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Attendance"),e("p",{class:"mt-1 text-sm text-gray-500"}," Track and manage student attendance ")],-1)),l(M,{onClick:j,variant:"primary"},{default:n(()=>[l(d(L),{class:"h-5 w-5 mr-2"}),t[0]||(t[0]=i(" Mark Attendance ",-1))]),_:1})]),e("div",q,[l(p,{class:"p-6"},{default:n(()=>[e("div",z,[e("div",null,[t[2]||(t[2]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Records",-1)),e("p",G,r(o.value.length),1),t[3]||(t[3]=e("p",{class:"mt-1 text-xs text-gray-500"},"All time",-1))]),e("div",J,[l(d(h),{class:"h-8 w-8 text-blue-600"})])])]),_:1}),l(p,{class:"p-6"},{default:n(()=>[e("div",K,[e("div",null,[t[4]||(t[4]=e("p",{class:"text-sm font-medium text-gray-600"},"Attendance Rate",-1)),e("p",Q,r(S.value)+"% ",1),t[5]||(t[5]=e("p",{class:"mt-1 text-xs text-green-600"},"Overall",-1))]),e("div",W,[l(d(P),{class:"h-8 w-8 text-green-600"})])])]),_:1}),l(p,{class:"p-6"},{default:n(()=>[e("div",X,[e("div",null,[t[6]||(t[6]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Hours",-1)),e("p",Y,r(C.value),1),t[7]||(t[7]=e("p",{class:"mt-1 text-xs text-gray-500"},"Hours taught",-1))]),e("div",Z,[l(d(R),{class:"h-8 w-8 text-purple-600"})])])]),_:1})]),c.value?(m(),_("div",dt,[...t[8]||(t[8]=[e("div",{class:"h-64 rounded-xl bg-gray-200 animate-pulse"},null,-1)])])):(m(),B(E,{key:0,title:"Attendance Records",columns:k,data:o.value,searchable:!0,paginated:!0,filters:w,"items-per-page":25,"row-key":"id"},{"cell-student":n(({row:s})=>[e("div",tt,[e("div",et,[e("span",st,r(s.student.split(" ").map(f=>f[0]).join("").toUpperCase().slice(0,2)),1)]),e("span",at,r(s.student),1)])]),"cell-class":n(({row:s})=>[e("div",lt,r(s.class||"—"),1)]),"cell-date":n(({row:s})=>[e("div",nt,[l(d(h),{class:"h-4 w-4 text-gray-400"}),i(" "+r(s.date?new Date(s.date).toLocaleDateString():"—"),1)])]),"cell-duration":n(({row:s})=>[l(v,{variant:"secondary"},{default:n(()=>[i(r(s.duration||"—"),1)]),_:2},1024)]),"cell-status":n(({row:s})=>[l(v,{variant:s.status==="present"?"success":s.status==="absent"?"danger":"warning"},{default:n(()=>[i(r(s.status||"present"),1)]),_:2},1032,["variant"])]),"cell-hours":n(({row:s})=>[e("div",rt,r(parseFloat(s.hours||0).toFixed(2))+"h ",1)]),"row-actions":n(({row:s})=>[e("button",{onClick:f=>F(s),class:"rounded-lg p-2 text-gray-400 hover:bg-gray-100 hover:text-blue-600 transition-colors",title:"View Details"},[l(d(I),{class:"h-5 w-5"})],8,ot)]),_:1},8,["data"]))])]),_:1})],64))}};export{wt as default};
